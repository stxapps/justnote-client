* Inspiring Adversary
** evernote.com
** Google Keep
** bear.app
** collectednotes.com
** joplinapp.org
** github.com/mozilla/notes
** wereturtle.github.io/ghostwriter
** milanote.com
** cloverapp.co
** nat.app/note-taking
** gekri.com
** www.zotero.org
** usejournal.com
** getpolarized.io
** github.com/zadam/trilium
** github.com/logseq/logseq
** github.com/twitter/TwitterTextEditor
** www.serenity.re/en/notes
* Same Name
** jusnote.com - The most powerful software for managing the legal practice
** justnotepad.com
** justnoteit.com
** play.google.com/store/apps/details?id=enterprise.velle.justnote
** play.google.com/store/apps/details?id=app.pnrnts.notes.notes
** github.com/pavlo-zin/JustNote
** github.com/tseleski/JustNote
** www.macupdate.com/app/mac/33266/justnotes
* Requirements
** simple, fast, intuitive
- quick notes VS in-depth essays
- focus mode
- advanced markup options
- dark mode, themes, fonts
** sync
** export
** share
- direct url to the note, to other's note? another specific view?
- iOS, Android extensions?
- Chrome, Firefox extensions?
** popup and back
** fast
- while loading data from server, new note button should be clickable and can add a new note right away
** lists
** tags
** Live demo
- No need, super easy to try, no setup
* POC
** domain name
- http://justnote.cc
- http://www.justnote.cc
- https://justnote.cc <-- choose this one
- https://www.justnote.cc
** Consistent in name
- Justnote
** fonts
- Atkinson Hyperlegible Font: brailleinstitute.org/freefont
  + Might not enough. There only regular and bold
- Inter <-- choose this one
** All Notes VS My Notes
- Notebooks? Lists?
- My Notes, Archive, Trash, <-- choose this one
** supported screens
- 5 screens: desktop, tablet:portrait, tablet:landscape, mobile:portrait, mobile:landscape
- breakpoint at lg
- Sidebar, Note list, Note editor
  + should be able to adjust width?
- Fixed topbar, Fixed bottombar
** Flow
*** Sign up / Sign in
*** Create a new note
*** list notes
*** Open a note
*** Edit/Update/Save a note
*** Move a note: archive, remove, restore, move to
*** Delete a note: permanently delete
*** Change listname
*** Create a new listname <-- in Settings
*** Rename/Delete a listname <-- in Settings
*** Bulk edit: archive, remove, restore, move to, delete
*** Profile: settings, support, sign out
*** Sync indicator: syncing, new update,
*** StatusPopup
*** Search
*** Delete old notes in trash, export data, delete all data
** url hash
- Also use url for popup and confirm delete!
- url: https://justnote.cc
  + /, /about, /privacy, /terms, /support
  + /#?u=<username>&n=<note-id>&p=<popup-id>&cd=true
** routers
*** web
- No need react-router, use framer-motion
*** native
- No need react-navigation, use animated
** components
*** sidebar
- show/hide sidebar, need a button to click to show!
*** note list
*** editor
*** search
- need to add top padding dynamically?
*** split screens
- github.com/tomkp/react-split-pane
- github.com/brucelin0325/react-native-resizable-flex-panes
- github.com/STRML/react-grid-layout
** z-index
- 0: note list, note
- 10: search popup
- 20: top bar, bottom bar
- 30: popup
- 40: setting popup
- 50: confirm delete
** loading
*** web
*** native
** offline and sync in mobile app
*** foundings
- versioning/conflict/merge with file name!
- delete need to keep all files!
- fpath: notes/<listname>/<fname>/index.json
- fname: <timestamp><4 random chars>-parents
- delete: add new one w/o content and update old one w/o content
- sqlite on mobile
*** storage on mobile
- github.com/react-native-async-storage/async-storage
  + slower
  + on Android, need to set storage size limit
- github.com/mrousavy/react-native-mmkv
- github.com/ammarahm-ed/react-native-mmkv-storage
  + Faster
  + based on Tencent MMKV which should be ok
  + No need to set storage size limit
  + might need to trim storage size!
  + might have issues with JSI, Hermes and Proguard!
** data
*** Gaia
- /notes/<listName>/<id>_<parentIds>/index.json
  + title
  + body
- /notes/<listName>/<id>_<parentIds>/[*.* i.e. jpg, png]
*** noteId
- id, parentIds, addedDT, updatedDT, isConflicted, conflictWith, listName, fpaths,
*** Redux state
- notes[listName][id]
  + parentIds
  + id
  + title
  + body
  + media: {
      <name>: <content>,
      ...
    }
  + addedDT
  + updatedDT
** text editor
*** view mode vs edit mode
*** file format!
- web vs native
*** inline image
*** how and when to save
*** libraries
**** Quill
- github.com/quilljs/quill, github.com/imnapo/react-native-cn-quill
- Need to upload an image to server and use <img> tag?
  + No, can use data image encoding but the file will be large
  + Need to manually extract from a note file?
- Need to install plugin to resize an image
- There's a bug on editing a very long article and no fix?
- Production version is very old and no promise on newer version, dead project?
- BSD license
**** TinyMCE
- github.com/tinymce/tinymce, github.com/rmccue/react-native-tinymce
- High development activities
- there are paid plans
- support insert a table and resize an image
- require to show their name&logo as attribution!
- Use webview on react-native, bad for performance?
- Obscure js code to prevent malicious hackers?
- there's an option to upload an image and have data URL?
- GNU LGPL license and require attribution
**** Trix
- github.com/basecamp/trix, github.com/vitalyliber/react-native-trix
- need to use WebView on react-native
- MIT license
**** Slate
- github.com/ianstormtaylor/slate
- Not support mobile browser for now, in development
- Need to use WebView on react-native
**** DraftJs
- draftjs.org
- Not officially support mobile browser, there're known issues
- Need to use WebView on react-native
**** Wordpress Gutenberg
- github.com/WordPress/gutenberg, github.com/wordpress-mobile/gutenberg-mobile
- This's not just a text editor, it's a block editor for making a web page or a blog. Maybe this's too much?
- React native library
- GNU GPL license
**** CKEditor
- github.com/ckeditor/ckeditor5-react, github.com/ssg-luke/react-native-ckeditor5, github.com/mzupek/react-native-ckeditor5
- GNU GPL license
- well suport on mobile browser
- Need to use WebView on react-native
* MVP
* Fully Fledged
* Implementation
** Web steps
- npx create-react-app justnotecc --template cra-template-pwa
- yarn add tailwindcss postcss postcss-cli autoprefixer
- yarn add @tailwindcss/forms @tailwindcss/typography @tailwindcss/aspect-ratio @tailwindcss/line-clamp
- npx tailwindcss init
- yarn add npm-run-all
- yarn add redux react-redux redux-loop
- yarn add @welldone-software/why-did-you-render
- Fix dev server crash because of Emacs temp/lock file
  + github.com/facebook/create-react-app/issues/9056#issuecomment-744168146
  + stackoverflow.com/questions/62567370/reactjs-local-server-crashes-after-editing-file-in-emacs-even-without-saving/62571200#62571200
- Favicon
  + cd public
  + convert logo16.png logo32.png logo48.png logo64.png favicon.ico
- Font
  + Config in tailwind.config.js
  + Add font-face in layer: base in tailwind.css
- yarn add url-parse
- yarn add framer-motion
- yarn add @stacks/auth @stacks/storage @stacks/connect
  + @stacks/auth still has delete etag bug!, need to update to newer version
  + @stacks/connect still depends on blockstack, not @stacks/auth, need to update to newer version
- yarn add blockstack --dev
  + Need to remove when @stacks/connect not depends to
- yarn add reselect
- yarn add file-saver
- yarn add @ckeditor/ckeditor5-react
- yarn add file:../../../ckeditor5/packages/ckeditor5-build-decoupled-document
** Server steps
*** s3
- Set public and enable CORS
*** cloudfront, lambda@edge, certificate manager, and namecheap
- Create SSL certificate and verify at namecheap
- Create cloudfront distribution
- Create a lambda function named redirectUrl, comes with a role i.e. redirectUrl-role-xxxxx, need to add more policies to that role like a lot
- At that role -> Trust relationships, edit that json to contain server: edgelambda.amazonaws.com
- Back to the function page -> Designer -> Add trigger, select cloudfront -> deploy to Lambda@Edge, select the correct distribution and select Viewer request.
- Set cloudfront url in namecheap
*** aws-cli
- create justnote-cli user in IAM with S3FullAccess and CloudFrontFullAccess
- aws-cli supports multiple users/profiles, add in ~/.aws/config and ~/.aws/credentials
- every command follows by --profile <name>
** Native steps
- npx react-native init Justnotecc
- yarn add https://github.com/bracedotto/tailwind-rn#8331da648ea06c6762f737600f40a947c3891b93
- yarn add redux react-redux redux-loop
- yarn add babel-plugin-inline-import --dev
  + Update babel.config.js to work with .svg
- yarn add @welldone-software/why-did-you-render --dev
- Font
  + Create react-native.config.js
  + Run npx react-native link
  + medium.com/@mehrankhandev/ultimate-guide-to-use-custom-fonts-in-react-native-77fcdf859cf4
- yarn add url-parse
- yarn add react-native-safe-area-context
- yarn add react-native-svg
- yarn add 'https://gitpkg.now.sh/bracedotto/blockstack-react-native/BlockstackSDK?e333bd3216453a78428c76b09d5d5e7450681a64'
- yarn add reselect
- yarn add react-native-fast-image
- yarn add react-native-mmkv-storage (use 0.4.4 for now to be able to debug)
  + Add pickFirst in build.gradle
  + Add proguard rules
  + require iOS target to 11.0
- yarn add react-native-animated-spinkit
- yarn add react-native-keyboard-manager
- yarn add react-native-webview
- Android
  + android/gradle/wrapper/gradle-wrapper.properties
    ~ set gradle version in zip fpath
  + android/build.gradle
    ~ set android gradle plugin version
    ~ set minSdk, targetSdk, compileSdk, buildTools version
  + gen upload keystore
    ~ keytool -genkeypair -v -keystore justnote-android-upload-key.keystore -alias justnote-android-upload-key -keyalg RSA -keysize 2048 -validity 10000
  + android/gradle.properties
    ~ add variables for upload keystore
    ~ add more memory when build (stackoverflow.com/questions/56075455/expiring-daemon-because-jvm-heap-space-is-exhausted)
  + android/app/build.gradle
    ~ enableHermes: true
    ~ enableProguardInReleaseBuilds = true
    ~ add exclude fpaths in packagingOptions in android block
    ~ add upload keystore in signingConfigs in android block
    ~ add javaMaxHeapSize in android block
  + android/app/proguard-rules.pro
    ~ add proguard rules
  + android/app/src/main/AndroidManifest.xml
    ~ Add 2 intent filters: justnotecc:// and https://justnote.cc
  + android/app/src/main/res/values/strings.xml
    ~ app_name Justnote
  + android/app/src/main/res/mipmap-xxxx
    ~ ic_launcher
- iOS
  + ios/Podfile
    ~ Add PromiseObjC and Blockstack dependencies
    ~ Change platform version
  + Xcode/Justnotecc/Project
    ~ set iOS Deployment Target
  + Xcode/Justnotecc/Targets
    ~ set Display Name, Bundle Id, Version, Build, Deployment Info
    ~ set team
    ~ Add justnotecc://
  + Xcode/Justnotecc/Targets/Signing & Capabilities
    ~ Click + and double clicks Associated Domains
    ~ Add applinks:justnote.cc
  + Xcode/Images.xcassets
    ~ app icons
  + ios/Justnotecc/AppDelegate.m
    ~ Add source code
  + ios/Justnotecc/Targets/Build Settings
    ~ Search Paths/Library Search Paths: both Debug and Release add "${SDKROOT}/usr/lib/swift" non-recursive (developer.apple.com/forums/thread/655438)
- Setup Universal Link and App Link on server
   + Upload assetlinks.json to justnote.cc/.well-known/, *not .wellknown!*
    ~ assume debug.keystore unchanged: git update-index --assume-unchanged packages/mobile/android/app/debug.keystore
    ~ generate a new debug.keystore and don't publish to github
    ~ generate sha256 for debug.keystore, make sure these two keystores never be published (*if passowrd contains $, put single quote around!*)
      keytool -list -v -keystore ~/.android/debug.keystore -alias androiddebugkey -storepass android -keypass android
      keytool -list -v -keystore android/app/debug.keystore -alias androiddebugkey -storepass android -keypass android
    ~ *Need sha256 from Play Store Console* at Release Management > App signing > App signing certificate > SHA-256 certificate fingerprint (medium.com/@joeykaan/the-definitive-guide-to-app-links-eef50a4c26e9)
   + Upload apple-app-site-association to justnote.cc/.well-known, *not .wellknown and content type application/json!*
* test users
- No username: piece garlic material chronic dad possible beauty jealous elephant cage still rule
- No username: open below advance dolphin wolf man never useless maximum clock proof bike
- No username: angry juice scatter parrot spider remind tuna crash giggle section isolate film
* test cases
- web, mobile
- PC, laptop, tablet, phone
- features
  + Landing, About, Terms, Privacy, Support
  + Main, ColsPanel, NavPanel, Sidebar, RightPanel
  + List notes, fetch more
  + New note, edit note, move note, delete note
  + Bulk edit: move notes, permanently delete notes
  + Search
  + Sync, Conflict notes
  + List list names, change list name
  + New list name, edit list name, move list name, delete list name
  + Popups: ConfirmDelete, ConfirmDiscard, MoveTo, ListMenu, Profile
  + Settings
* servers
** test server
- https://d2kp6vvq64w651.cloudfront.net
** prod
- https://justnote.cc
