(self.webpackChunkjustnotecc=self.webpackChunkjustnotecc||[]).push([[787],{1787:(t,e,o)=>{"use strict";o.r(e),o.d(e,{addListNames:()=>ht,addLockList:()=>qe,addLockNote:()=>Le,addNote:()=>R,addTagEditorTagName:()=>Ve,addTagNames:()=>no,bulkPinNotes:()=>Ae,bulkUnpinNotes:()=>ke,cancelChangedSyncMode:()=>Ut,cancelDiedNotes:()=>Z,cancelDiedPins:()=>ve,cancelDiedSettings:()=>Ot,cancelDiedTags:()=>eo,changeListName:()=>k,checkDeleteListName:()=>mt,checkDeleteTagName:()=>lo,cleanUpPins:()=>Ie,cleanUpSslts:()=>V,cleanUpStaticFiles:()=>ct,cleanUpTags:()=>oo,deleteListNames:()=>wt,deleteNotes:()=>Y,deleteOldNotesInTrash:()=>nt,deleteTagNames:()=>co,disableSyncMode:()=>jt,discardNote:()=>z,fetch:()=>x,fetchMore:()=>O,increaseChangeListNameCount:()=>ee,increaseDiscardNoteCount:()=>te,increaseFocusTitleCount:()=>se,increaseResetDidClickCount:()=>re,increaseSaveNoteCount:()=>Zt,increaseSetInitDataCount:()=>ne,increaseShowNLIMPopupCount:()=>le,increaseShowNoteListMenuPopupCount:()=>ie,increaseShowUNEPopupCount:()=>ce,increaseUpdateEditorWidthCount:()=>ae,increaseUpdateQueryStringCount:()=>oe,lockCurrentList:()=>Qe,lockNote:()=>je,mergeNotes:()=>tt,mergeSettings:()=>Bt,moveListName:()=>yt,moveNotes:()=>W,moveNotesWithAction:()=>K,movePinnedNote:()=>we,moveTagName:()=>ro,moveToListName:()=>gt,onChangeListName:()=>S,onShowNLIMPopup:()=>lt,onShowNoteListMenuPopup:()=>rt,onShowUNEPopup:()=>_e,onUpdateQueryString:()=>M,pinNotes:()=>fe,randomHouseworkTasks:()=>st,removeLockList:()=>Re,removeLockNote:()=>Oe,retryDiedNotes:()=>H,retryDiedPins:()=>Ne,retryDiedSettings:()=>$t,retryDiedTags:()=>to,runAfterFetchTask:()=>ot,saveNote:()=>G,showAddLockEditorPopup:()=>Te,showLockMenuPopup:()=>$e,showNLIMPopup:()=>it,showNoteListMenuPopup:()=>at,showUNEPopup:()=>Ue,sync:()=>Rt,syncAndWait:()=>Qt,tryUpdateFetched:()=>L,tryUpdateFetchedMore:()=>j,tryUpdateInfo:()=>_t,tryUpdateSynced:()=>Gt,unlockList:()=>Ge,unlockNote:()=>Be,unpinNotes:()=>ge,updateDeleteAction:()=>Vt,updateDiscardAction:()=>Jt,updateDoDeleteOldNotesInTrash:()=>vt,updateDoDescendingOrder:()=>At,updateDoMoreEditorFontSizes:()=>Mt,updateDoSectionNotesByMonth:()=>Pt,updateDoSyncMode:()=>bt,updateDoSyncModeInput:()=>Nt,updateDoUseLocalTheme:()=>Se,updateEditingNote:()=>ue,updateEditorBusy:()=>Kt,updateEditorFocused:()=>Xt,updateEditorIsUploading:()=>de,updateEditorScrollEnabled:()=>pe,updateFetched:()=>$,updateFetchedMore:()=>U,updateHubAddr:()=>A,updateListNameEditors:()=>ut,updateListNames:()=>ft,updateListNamesMode:()=>Yt,updateLockAction:()=>Ee,updateLockEditor:()=>Ce,updateMoveAction:()=>Wt,updateNote:()=>Q,updateNoteDateFormat:()=>St,updateNoteDateShowingMode:()=>kt,updatePaywallFeature:()=>he,updateQueryString:()=>P,updateSelectingListName:()=>Ft,updateSelectingNoteId:()=>F,updateSelectingTagName:()=>po,updateSettingsPopup:()=>dt,updateSettingsViewId:()=>pt,updateSidebarListNamesMode:()=>Ht,updateSortOn:()=>It,updateStgsAndInfo:()=>Lt,updateSynced:()=>zt,updateTagData:()=>Je,updateTagDataTStep:()=>Ze,updateTagEditor:()=>We,updateTagEditorPopup:()=>Ke,updateTagNameColor:()=>io,updateTagNameEditors:()=>so,updateTagNames:()=>ao,updateTheme:()=>Pe,updateThemeCustomOptions:()=>De,updateTimePick:()=>Fe,updateUpdatingThemeMode:()=>Me,viewNoteAsWebpage:()=>xe});var s=o(7411),n=o.n(s),a=o(3704),r=o(2517),i=o(8565),l=o(1678),c=o(3372),d=o(559),p=o(8583),u=o(629),h=o(8103),f=o(8159),y=o(1424),g=o(6163),m=o(6461),w=o(1930),b=o(8678),N=o(9699),v=o(5566);const I=o(3848),A=()=>(t,e)=>{try{if(!e().user.isUserSignedIn)return;e().user.hubUrl===f.THB&&t((0,N.e5)(f.ITW,!0));const o=i.A.loadUserData(),s=(0,y.K4)(o);t({type:h.E8m,payload:{hubAddr:s}})}catch(o){console.log("updateHubAddr error:",o)}},k=(t,e)=>async(o,s)=>{if(t||(t=b.Ay.changeListName.changingListName),!t)return void console.log("In changeListName, invalid listName:",t);if(e){if(b.Ay.updateSettings.doFetch||b.Ay.syncMode.didChange)return;if(s().editor.isUploading)return;if(s().display.isEditorFocused)return b.Ay.changeListName.changingListName=t,void o(ee())}const n=s().display.syncProgress;n&&n.status===f.X__&&o({type:h.JFm}),o($(null,!1,!0)),o(U(null,!0)),o({type:h.pqf,payload:t})},S=(t,e,o)=>async(s,n)=>{const{noteId:a}=n().display;b.Ay.keyboard.height>0&&s((0,N.xj)()),s(k(null,!1)),s((0,N.PU)(a,t,e,o))},P=(t,e)=>async(o,s)=>{if((0,y.Kg)(t)||(t=b.Ay.updateQueryString.updatingQueryString),!(0,y.Kg)(t))return void console.log("In updateQueryString, invalid queryString:",t);if(e){if(b.Ay.updateSettings.doFetch||b.Ay.syncMode.didChange)return;if(s().editor.isUploading)return;if(s().display.isEditorFocused)return b.Ay.updateQueryString.updatingQueryString=t,void o(oe())}const n=s().display.syncProgress;n&&n.status===f.X__&&o({type:h.JFm}),o($(null,!1,!0)),o(U(null,!0)),o({type:h.pMV,payload:t})},M=(t,e,o)=>async(s,n)=>{const{noteId:a}=n().display;b.Ay.keyboard.height>0&&s((0,N.xj)()),s(P(null,!1)),s((0,N.PU)(a,t,e,o))},F=t=>({type:h.GQ4,payload:t}),D=t=>{const e=[];for(const{id:o,isConflicted:s,isPinned:n}of t)e.push({id:o,isConflicted:!!s,isPinned:!!n});return e},x=()=>async(t,e)=>{const o=b.Ay.fetch.doForce;b.Ay.fetch.doForce=!1;const s=e().conflictedNotes,n=e().notes,a=e().display.listName,r=e().display.queryString,i=e().display.didFetch,l=e().display.didFetchSettings,d=e().display.fetchingInfos,p=e().display.doForceLock,u=e().pendingSslts,f=e().pendingPins,g=e().pendingTags,m=e().lockSettings.lockedNotes,w=e().lockSettings.lockedLists;let N=e().settings.sortOn,v=e().settings.doDescendingOrder,I=(0,y.tQ)(e()),A=(0,y.ln)(e()),k=(0,y.w5)(e()),S=(0,y.x$)(e());const P=r||a;if((0,y.ct)(P,o,d))return void(b.Ay.fetch.doShowLoading=!1);const M=`${Date.now()}${(0,y.DU)(4)}`;t(B({type:h.tHO,doForce:o,lnOrQt:P,fthId:M}));const F={fetchedNoteMetas:[],unfetchedNoteMetas:[],hasMore:!1};if(i&&l){let e,o;if(r){const t=(0,y.P2)({noteFPaths:I,ssltFPaths:A,pendingSslts:u,notes:n,sortOn:N,doDescendingOrder:v,pinFPaths:k,pendingPins:f,tagFPaths:S,pendingTags:g,doForceLock:p,lockedNotes:m,lockedLists:w,queryString:r});[e,o]=[t.metas,t.metasWithPcEc],F.hasMore=t.hasMore}else{const t=(0,y.$u)({noteFPaths:I,ssltFPaths:A,pendingSslts:u,notes:n,listName:a,sortOn:N,doDescendingOrder:v,pinFPaths:k,pendingPins:f});[e,o]=[t.metas,t.metasWithPcEc],F.hasMore=t.hasMore}for(const t of e)(0,y.FV)(b.Ay.fetch.fetchedNoteIds,s,n,t)?F.fetchedNoteMetas.push(t):F.unfetchedNoteMetas.push(t);if(0===F.unfetchedNoteMetas.length){const e={infos:D(o),hasMore:F.hasMore,doClearSelectedNoteIds:!0};return P===a&&0===F.fetchedNoteMetas.length&&(e.listNameToClearNotes=P),t({type:h.u$J,payload:e}),(0,y.Q2)(P,null,null,b.Ay),t(q(M)),void(b.Ay.fetch.doShowLoading=!1)}}b.Ay.fetch.doShowLoading=!1;const x={listName:a,queryString:r,lnOrQt:P,fthId:M};t({type:h.tHO,payload:x});const E={};try{if(!i||!l){const t=await c.A.listFPaths(!0);[I,A]=[t.noteFPaths,t.ssltFPaths],[k,S]=[t.pinFPaths,t.tagFPaths];const[e,o]=[t.settingsFPaths,t.infoFPath],{noteMetas:s,conflictedMetas:i,toRootIds:l,inUseListNames:d}=(0,y.tk)(I,A,u),h=await c.A.fetchStgsAndInfo(e,o);let b;if(E.doFetchStgsAndInfo=!0,E.settings=h.settings,E.conflictedSettings=h.conflictedSettings,E.info=h.info,E.listNames=d,E.tagNames=(0,y.Vr)(s,i,l,S,g),E.settings&&(N=E.settings.sortOn,v=E.settings.doDescendingOrder),r){const t=(0,y.P2)({noteFPaths:I,ssltFPaths:A,pendingSslts:u,notes:n,sortOn:N,doDescendingOrder:v,pinFPaths:k,pendingPins:f,tagFPaths:S,pendingTags:g,doForceLock:p,lockedNotes:m,lockedLists:w,queryString:r});[b,F.hasMore]=[t.metas,t.hasMore]}else{const t=(0,y.$u)({noteFPaths:I,ssltFPaths:A,pendingSslts:u,notes:n,listName:a,sortOn:N,doDescendingOrder:v,pinFPaths:k,pendingPins:f});[b,F.hasMore]=[t.metas,t.hasMore]}for(const n of b)F.unfetchedNoteMetas.push(n)}const t=await c.A.fetchNotes(F.unfetchedNoteMetas);E.fetchedNoteMetas=F.fetchedNoteMetas,E.unfetchedNoteMetas=F.unfetchedNoteMetas,E.hasMore=F.hasMore,E.conflictedNotes=t.conflictedNotes,E.notes=t.notes}catch(C){console.log("fetch error: ",C);const o=e().localSettings.signInDT;return t({type:h.EdN,payload:{...x,error:C,signInDT:o}}),void t(q(M))}t({type:h.X7M,payload:{...x,...E}})},E=(t,e,o)=>t.map((t=>{const{id:s}=t;let n=e;return(0,y.Gv)(n[s])?n[s]:(n=o,(0,y.Gv)(n[s])?n[s]:null)})),C=(t,e,o)=>t.map((t=>{const{listName:s,id:n}=t;let a=e;return(0,y.Gv)(a[s])&&(0,y.Gv)(a[s][n])?{listName:s,note:a[s][n]}:(a=o,(0,y.Gv)(a[s])&&(0,y.Gv)(a[s][n])?{listName:s,note:a[s][n]}:{listName:null,note:null})})),T=(t,e,o)=>{const s=[];for(const n of t)s.push({id:n.id,isConflicted:!0,isPinned:!1});for(const n of e)s.push({id:n.id,isConflicted:!1,isPinned:!0});for(const n of o)s.push({id:n.id,isConflicted:!1,isPinned:!1});return s},L=t=>async(e,o)=>{b.Ay.syncMode.doSyncMode||e(A()),e($(t)),e(q(t.fthId))},$=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return async(s,n)=>{if(!t)return;const a=n().conflictedNotes,r=n().notes,i=n().pendingSslts,l=n().pendingPins,c=n().settings.sortOn,d=n().settings.doDescendingOrder,p=(0,y.tQ)(n()),u=(0,y.ln)(n()),g=(0,y.w5)(n()),{toRootIds:w}=(0,y.tk)(p,u,i),N=[],v=[],{fetchedNoteMetas:I,unfetchedNoteMetas:A}=t;for(const t of[...I,...A])t.isConflicted?N.push(t):v.push(t);const k={},S=E(N,t.conflictedNotes,a);for(const t of S)(0,y.Gv)(t)&&(k[t.id]=t);const P={},M=[],F=C(v,t.notes,r);for(const{listName:t,note:e}of F)(0,y.Kg)(t)&&(0,y.Gv)(e)&&((0,y.Gv)(P[t])||(P[t]={}),P[t][e.id]=e,M.push(e));if(o)return s({type:h.EQt,payload:{lnOrQt:t.lnOrQt,conflictedNotes:k,notes:P}}),void(0,y.Q2)(t.lnOrQt,t.conflictedNotes,t.notes,b.Ay);const D=[],x=[];if((0,y.Gv)(r[t.lnOrQt]))for(const e of Object.values(r[t.lnOrQt]))e.status!==f.jjN&&D.push(e),Array.isArray(b.Ay.notesReducer.interveningNoteIds[t.lnOrQt])&&b.Ay.notesReducer.interveningNoteIds[t.lnOrQt].includes(e.id)&&x.push(e);const L=(0,y.Ie)(S,c,d);let $=[...M,...x,...D];$=Object.values(m._.mapKeys($,f.ID)),$=(0,y.Ie)($,c,d);const{pinnedValues:O,values:j}=(0,y.pz)($,g,l,w,(t=>(0,y.ju)(t,w))),U=T(L,O,j);s({type:h.EQt,payload:{lnOrQt:t.lnOrQt,conflictedNotes:k,notes:P,infos:U,hasMore:t.hasMore,doChangeListCount:e,doClearSelectedNoteIds:!0}}),(0,y.Q2)(t.lnOrQt,t.conflictedNotes,t.notes,b.Ay)}},O=()=>async(t,e)=>{const o=e().conflictedNotes,s=e().notes,n=e().display.listName,a=e().display.queryString,r=e().display.fetchingInfos,i=e().display.showingNoteInfos,l=e().display.doForceLock,d=e().fetchedMore,p=e().pendingSslts,u=e().pendingPins,f=e().pendingTags,g=e().lockSettings.lockedNotes,m=e().lockSettings.lockedLists,w=e().settings.sortOn,N=e().settings.doDescendingOrder,v=(0,y.tQ)(e()),I=(0,y.ln)(e()),A=(0,y.w5)(e()),k=(0,y.x$)(e());if(!Array.isArray(i))return void console.log("In fetchMore, showingNoteInfos is not an array!");const S=a||n;if((0,y.TJ)(S,r)||S in d)return;const P=`${Date.now()}${(0,y.DU)(4)}`;t(B({type:h.Dx0,lnOrQt:S,fthId:P}));const M=[],F=i.map((t=>t.id.startsWith("conflict")?o[t.id]:(0,y.vW)(t.id,s)));for(const c of F)if((0,y.Gv)(c))if(c.isConflicted){c.notes.every((t=>b.Ay.fetch.fetchedNoteIds.includes(t.id)))&&M.push(c.id)}else b.Ay.fetch.fetchedNoteIds.includes(c.id)&&M.push(c.id);const x={fetchedNoteMetas:[],unfetchedNoteMetas:[],hasMore:!1,hasDisorder:!1};let E,C;if(a){const t=(0,y.P2)({noteFPaths:v,ssltFPaths:I,pendingSslts:p,notes:s,sortOn:w,doDescendingOrder:N,pinFPaths:A,pendingPins:u,tagFPaths:k,pendingTags:f,doForceLock:l,lockedNotes:g,lockedLists:m,queryString:a,excludingIds:M});[E,C]=[t.metas,t.metasWithPcEc],[x.hasMore,x.hasDisorder]=[t.hasMore,t.hasDisorder]}else{const t=(0,y.$u)({noteFPaths:v,ssltFPaths:I,pendingSslts:p,notes:s,listName:n,sortOn:w,doDescendingOrder:N,pinFPaths:A,pendingPins:u,excludingIds:M});[E,C]=[t.metas,t.metasWithPcEc],[x.hasMore,x.hasDisorder]=[t.hasMore,t.hasDisorder]}for(const c of E)(0,y.FV)(b.Ay.fetch.fetchedNoteIds,o,s,c)?x.fetchedNoteMetas.push(c):x.unfetchedNoteMetas.push(c);if(0===x.unfetchedNoteMetas.length){x.hasDisorder&&console.log("No cache for now. Maybe fast enough to not jumpy.");const e=D(C);return t({type:h.u$J,payload:{infos:e,hasMore:x.hasMore}}),void t(q(P))}const T={listName:n,queryString:a,lnOrQt:S,fthId:P,safNoteIds:M};t({type:h.Dx0,payload:T});const L={};try{const t=await c.A.fetchNotes(x.unfetchedNoteMetas);L.fetchedNoteMetas=x.fetchedNoteMetas,L.unfetchedNoteMetas=x.unfetchedNoteMetas,L.hasMore=x.hasMore,L.hasDisorder=x.hasDisorder,L.conflictedNotes=t.conflictedNotes,L.notes=t.notes}catch($){return console.log("fetchMore error: ",$),t({type:h.sON,payload:{...T,error:$}}),void t(q(P))}t({type:h.bKm,payload:{...T,...L}})},j=t=>async(e,o)=>{const s=o().display.listName,n=o().display.queryString,a=o().display.fetchingInfos,r=o().display.showingNoteInfos;if((0,y.zN)(t.fthId,a)||!Array.isArray(r))return void e(q(t.fthId));const i=n||s;if(t.lnOrQt!==i)return e(U(t,!0)),void e(q(t.fthId));if(!t.hasDisorder)return e(U(t)),void e(q(t.fthId));if(!o().display.isBulkEditing){const s=b.Ay.scrollPanel.contentHeight,n=b.Ay.scrollPanel.layoutHeight+b.Ay.scrollPanel.scrollY,a=o().display.isNoteListItemMenuPopupShown||o().display.isListNamesPopupShown||o().display.isPinMenuPopupShown||o().display.isLockMenuPopupShown;if(n>.96*s&&!a)return e(U(t)),void e(q(t.fthId))}e({type:h.BcB,payload:t}),e(q(t.fthId))},U=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async(o,s)=>{if(!t){const e=s().display.listName,o=s().display.queryString,n=o||e,a=s().fetchedMore[n];a&&({payload:t}=a)}if(!t)return;const n=s().conflictedNotes,a=s().notes,r=s().display.showingNoteInfos,i=s().pendingSslts,l=s().pendingPins,c=s().settings.sortOn,d=s().settings.doDescendingOrder,p=(0,y.tQ)(s()),u=(0,y.ln)(s()),g=(0,y.w5)(s());if(!Array.isArray(r))return void o({type:h.uTP,payload:{lnOrQt:t.lnOrQt}});if(e)return o({type:h.uTP,payload:{lnOrQt:t.lnOrQt,conflictedNotes:t.conflictedNotes,notes:t.notes}}),void(0,y.Q2)(t.lnOrQt,t.conflictedNotes,t.notes,b.Ay);const{toRootIds:w}=(0,y.tk)(p,u,i),N=[];if((0,y.Gv)(a[t.lnOrQt]))for(const e of Object.values(a[t.lnOrQt]))e.status!==f.jjN&&N.push(e);const v=[],I=[];for(const t of r){if(t.id.startsWith("conflict")){const e=n[t.id];(0,y.Gv)(e)&&v.push(e);continue}const e=(0,y.vW)(t.id,a);(0,y.Gv)(e)&&I.push(e)}const A=[],k=[],{fetchedNoteMetas:S,unfetchedNoteMetas:P}=t;for(const t of[...S,...P])t.isConflicted?A.push(t):k.push(t);let M=E(A,t.conflictedNotes,n);M=M.filter((t=>(0,y.Gv)(t)));const F=[],D=C(k,t.notes,a);for(const{listName:t,note:e}of D)(0,y.Kg)(t)&&(0,y.Gv)(e)&&F.push(e);let x=[...v,...M];x=Object.values(m._.mapKeys(x,f.ID)),x=(0,y.Ie)(x,c,d);let L=[...I,...F,...N];L=Object.values(m._.mapKeys(L,f.ID)),L=(0,y.Ie)(L,c,d);const{pinnedValues:$,values:O}=(0,y.pz)(L,g,l,w,(t=>(0,y.ju)(t,w))),j=T(x,$,O);o({type:h.uTP,payload:{lnOrQt:t.lnOrQt,conflictedNotes:t.conflictedNotes,notes:t.notes,infos:j,hasMore:t.hasMore}}),(0,y.Q2)(t.lnOrQt,t.conflictedNotes,t.notes,b.Ay)}},_=async(t,e)=>{const o=e().conflictedNotes,s=e().notes,n=e().display.showingNoteInfos,a=e().pendingSslts,r=e().pendingPins,i=e().settings.sortOn,l=e().settings.doDescendingOrder,c=(0,y.tQ)(e()),d=(0,y.ln)(e()),p=(0,y.w5)(e());if(!Array.isArray(n))return;const{toRootIds:u}=(0,y.tk)(c,d,a),g=[],w=[];for(const h of n){if(h.id.startsWith("conflict")){const t=o[h.id];(0,y.Gv)(t)&&g.push(t);continue}const t=(0,y.vW)(h.id,s);(0,y.Gv)(t)&&w.push(t)}let b=[...g];b=Object.values(m._.mapKeys(b,f.ID)),b=(0,y.Ie)(b,i,l);let N=[...w];N=Object.values(m._.mapKeys(N,f.ID)),N=(0,y.Ie)(N,i,l);const{pinnedValues:v,values:I}=(0,y.pz)(N,p,r,u,(t=>(0,y.ju)(t,u))),A=T(b,v,I);t({type:h.u$J,payload:{infos:A}})},B=t=>({type:h.M09,payload:t}),q=t=>({type:h.oLG,payload:t}),R=(t,e,o,s)=>async(n,a)=>{(0,y.Kg)(s)||(s=a().display.listName),s===f.tA0&&(s=f.NgB);const r=a().display.queryString;r&&(s=f.NgB);const i=Date.now(),l={parentIds:null,id:`${i}${(0,y.DU)(4)}`,title:t,body:e,media:o,addedDT:i,updatedDT:i},{usedFPaths:d,localUnusedFPaths:p}=(0,y.qM)(o,null);let u;if(r||s!==a().display.listName||(u=(t=>{const e=t().display.showingNoteInfos,o=t().settings.doDescendingOrder;if(!Array.isArray(e))return null;if(!o)return e.length;for(let s=0;s<e.length;s++)if(!e[s].isPinned)return s;return e.length})(a)),!(0,y.Et)(u)){const t=a().window.width;(0,y.Et)(t)&&t<f.lXt?(0,N.Aw)(null):n((0,N.RY)(null)),await(0,y.yy)(100)}const g={listName:s,note:l,insertIndex:u};n({type:h.fHL,payload:g}),(0,y.Q2)(null,null,[l],b.Ay);try{await c.A.putNotes({listNames:[s],notes:[l],staticFPaths:d})}catch(m){return console.log("addNote error: ",m),void n({type:h.e3x,payload:{...g,error:m}})}n({type:h.xjr,payload:g}),await et(null,null,p,a),n(Rt())},Q=(t,e,o,s)=>async(n,a)=>{const r=a().notes,i=a().settings.sortOn,l=Date.now(),{listName:d,note:p}=(0,y.z5)(s,r);if(!(0,y.Kg)(d)||!(0,y.Gv)(p))return void console.log("In updateNote, no found list name or note for id:",s);const u=(0,y.wg)(p,f.mhx),g={...u,parentIds:[u.id],id:`${l}${(0,y.DU)(4)}`,title:t,body:e,media:o,updatedDT:l,fromNote:u},{usedFPaths:m,serverUnusedFPaths:w,localUnusedFPaths:N}=(0,y.qM)(o,u.media),v={listName:d,fromNote:u,toNote:g};n({type:h.Hhj,payload:v}),i===f.Z2Y&&await _(n,a),(0,y.Q2)(null,null,[g],b.Ay);try{await c.A.putNotes({listNames:[d],notes:[g],staticFPaths:m})}catch(I){return console.log("updateNote error: ",I),void n({type:h.CJc,payload:{...v,error:I}})}n({type:h.BZf,payload:v}),await et([u.id],w,N,a),n(Rt())},G=(t,e,o)=>async(s,n)=>{if(""===t&&""===e)return void s(se());const{noteId:a}=n().display,r=a===f.cir?f.E7W:(0,y.vW)(a,n().notes);if(s((0,N.xj)()),r&&(0,y.hB)(r.title,t)&&(0,y.z_)(r.body,e))return s(Kt(!1)),void s((0,N.tA)([a]));a===f.cir?s(R(t,e,o)):s(Q(t,e,o,a))},z=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return async(s,n)=>{const{noteId:a}=n().display,r=a===f.cir?f.E7W:(0,y.vW)(a,n().notes);if(s((0,N.xj)()),t&&r&&(!(0,y.hB)(r.title,e)||!(0,y.z_)(r.body,o)))return s(Jt(f.CQI)),void(0,N.Bt)(f.dhM,!0);if(a===f.cir){const t=n().window.width;(0,y.Et)(t)&&t<f.lXt?(0,N.Aw)(null):s((0,N.RY)(null)),setTimeout((()=>s((0,N.tA)([a]))),100)}else s({type:h.wIL,payload:a})}},X=(t,e)=>async(o,s)=>{if(0===e.length)return;const n=s().notes,a=[],r=[],i=[],l=[];for(const c of e){const{listName:e,note:o}=(0,y.z5)(c,n);if(!(0,y.Kg)(e)||!(0,y.Gv)(o)){console.log("In moveNotes, no found list name or note for id:",c);continue}const[s,d]=[e,(0,y.wg)(o,f.mhx)];if(s===t){console.log("In moveNotes, same fromListName and toListName:",s);continue}const p={...d,fromListName:s,fromNote:d};a.push(s),r.push(d),i.push(t),l.push(p)}let d={fromListNames:a,fromNotes:r,toListNames:i,toNotes:l};o({type:h.qVE,payload:d}),(0,y.Q2)(null,null,l,b.Ay);try{const t=await c.A.moveNotes({listNames:i,notes:l});d={...d,...t}}catch(p){return console.log("moveNotes error: ",p),void o({type:h.xfN,payload:{...d,error:p}})}o({type:h.iXV,payload:d})},K=(t,e)=>async(o,s)=>{const{noteId:n,selectingNoteId:a,isBulkEditing:r,selectedNoteIds:i}=s().display;if(e===f.DEJ||e===f.ig$&&a===n){const t=s().window.width;!r&&(0,y.Et)(t)&&t<f.lXt?(0,N.Aw)(null):o((0,N.RY)(null))}if(e===f.DEJ)if(r){if(0===i.length)return void o(re());o(X(t,i)),(0,N.RW)(!1)}else o(X(t,[n]));else e===f.ig$?o(X(t,[a])):console.log("In moveNotes, invalid moveAction: ",e)},W=t=>async(e,o)=>{const{moveAction:s}=o().display;e(K(t,s))},V=()=>async(t,e)=>{const o=(0,y.tQ)(e()),s=(0,y.ln)(e()),{noteMetas:n,conflictedMetas:a,toRootIds:r,ssltInfos:i}=(0,y.tk)(o,s,{}),l=(0,y.O4)(n,a,r);let d=f.NrX;e().user.hubUrl===f.MbX&&(d=60);const p=[];for(const c of s){const{id:t}=(0,y.ds)(c),e=(0,y.ju)(t,r);if((!(0,y.Kg)(e)||!l.includes(e)||!(0,y.Gv)(i[e])||i[e].fpath!==c)&&(p.push({id:c,type:f.BCn,path:c,doIgnoreDoesNotExistError:!0}),p.length>=d))break}if(p.length>0)try{const t={values:p,isSequential:!1,nItemsForNs:f.NrX};await c.A.performFiles(t)}catch(u){console.log("cleanUpSslts error: ",u)}t(Rt())},J=t=>async(e,o)=>{if(0===t.length)return;const s=o().notes;let n=Date.now();const a=[],r=[],i=[],l=[];for(const c of t){const{listName:t,note:e}=(0,y.z5)(c,s);if(!(0,y.Kg)(t)||!(0,y.Gv)(e)){console.log("In deleteNotes, no found list name or note for id:",c);continue}const[o,d]=[t,(0,y.wg)(e,f.mhx)],p=`deleted${n}${(0,y.DU)(4)}`,u={...d,parentIds:[d.id],id:p,title:"",body:"",media:[],updatedDT:n,fromListName:o,fromNote:d};n+=1,a.push(o),r.push(d),i.push(o),l.push(u)}let d={fromListNames:a,fromNotes:r,toListNames:i,toNotes:l};e({type:h.QRu,payload:d}),(0,y.Q2)(null,null,l,b.Ay);try{const t=await c.A.putNotes({listNames:i,notes:l,manuallyManageError:!0});d={...d,...t}}catch(g){return console.log("deleteNotes error: ",g),void e({type:h.PNp,payload:{...d,error:g}})}e({type:h.oxs,payload:d});const p=[],u=[];for(const t of d.successNotes){p.push(t.fromNote.id);for(const{name:e}of t.fromNote.media)e.startsWith(f.d91+"/")&&u.push((0,y._$)(e))}await et(p,u,u,o),await ze(e,o),e(Rt())},Y=()=>async(t,e)=>{const{deleteAction:o,noteId:s,selectingNoteId:n,isBulkEditing:a,selectedNoteIds:r}=e().display;if(o===f.VSx||o===f.eNB&&n===s){const o=e().window.width;!a&&(0,y.Et)(o)&&o<f.lXt?(0,N.Aw)(null):t((0,N.RY)(null))}if(o===f.VSx)if(a){if(0===r.length)return;t(J(r)),(0,N.RW)(!1)}else t(J([s]));else o===f.eNB?(t(J([n])),(0,N.Bt)(f.nm0,!1)):console.log("In deleteNotes, invalid deleteAction: ",o)},H=t=>async(e,o)=>{const s=o().notes,n=o().settings.sortOn;let a=Date.now();for(const i of t){const{listName:t,note:l}=(0,y.z5)(i,s);if(!(0,y.Kg)(t)||!(0,y.Gv)(l)){console.log("In retryDiedNotes, no found listName or note for id:",i);continue}const{status:d}=l;if(d===f.X9C){const{usedFPaths:o}=(0,y.qM)(l.media,null),s={listName:t,note:l};e({type:h.fHL,payload:s});try{await c.A.putNotes({listNames:[t],notes:[l],staticFPaths:o})}catch(r){return console.log("retryDiedNotes add error: ",r),void e({type:h.e3x,payload:{...s,error:r}})}e({type:h.xjr,payload:s}),e(Rt())}else if(d===f.Qc5){const[s,a]=[l.fromNote,l],{usedFPaths:i,serverUnusedFPaths:d,localUnusedFPaths:p}=(0,y.qM)(a.media,s.media),u={listName:t,fromNote:s,toNote:a};e({type:h.Hhj,payload:u}),n===f.Z2Y&&await _(e,o);try{await c.A.putNotes({listNames:[t],notes:[a],staticFPaths:i})}catch(r){return console.log("retryDiedNotes update error: ",r),void e({type:h.CJc,payload:{...u,error:r}})}e({type:h.BZf,payload:u}),await et([s.id],d,p,o),e(Rt())}else if(d===f.o25){const[o,s]=[[l.fromListName],[l.fromNote]],[n,a]=[[t],[l]];let i={fromListNames:o,fromNotes:s,toListNames:n,toNotes:a,didRetry:!0};e({type:h.qVE,payload:i});try{const t=await c.A.moveNotes({listNames:n,notes:a});i={...i,...t}}catch(r){return console.log("retryDiedNotes move error: ",r),void e({type:h.xfN,payload:{...i,error:r}})}e({type:h.iXV,payload:i})}else{if(d!==f.qgH)throw new Error(`Invalid status: ${d} of id: ${i}`);{const[s,n]=[[t],[l]],i=[t],d=[{...l,parentIds:[l.id],id:`deleted${a}${(0,y.DU)(4)}`,title:"",body:"",media:[],updatedDT:a,fromListName:t,fromNote:l}];a+=1;const p=o().window.width;(0,y.Et)(p)&&p<f.lXt?(0,N.Aw)(null):e((0,N.RY)(null));let u={fromListNames:s,fromNotes:n,toListNames:i,toNotes:d};e({type:h.QRu,payload:u});try{const t=await c.A.putNotes({listNames:i,notes:d,manuallyManageError:!0});u={...u,...t}}catch(r){return console.log("retryDiedNotes delete error: ",r),void e({type:h.PNp,payload:{...u,error:r}})}e({type:h.oxs,payload:u});const g=[],m=[];for(const t of u.successNotes){g.push(t.fromNote.id);for(const{name:e}of t.fromNote.media)e.startsWith(f.d91+"/")&&m.push((0,y._$)(e))}await et(g,m,m,o),await ze(e,o),e(Rt())}}}},Z=t=>async(e,o)=>{const s=o().window.width;(0,y.Et)(s)&&s<f.lXt&&((0,N.Aw)(null),await(0,y.yy)(100));const n=o().notes,a=o().settings.sortOn,r=[],i=[],l=[],c=[],d=[];for(const u of t){const{listName:t,note:e}=(0,y.z5)(u,n);if(!(0,y.Kg)(t)||!(0,y.Gv)(e)){console.log("In cancelDiedNotes, no found listName or note for id:",u);continue}const{status:o,fromNote:s}=e;r.push(t),i.push(u),l.push(o),c.push((0,y.Gv)(s)?s.id:null),o===f.Qc5&&(0,y.Gv)(s)&&d.push(s.id)}const p={listNames:r,ids:i,statuses:l,fromIds:c,deleteUnsavedNoteIds:d};e({type:h.Ahu,payload:p}),a===f.Z2Y&&l.includes(f.Qc5)&&await _(e,o)},tt=t=>async(e,o)=>{const{noteId:s}=o().display,n=o().conflictedNotes[s],a=Date.now(),r=[],i=[],l=[];let d,p;for(let c=0;c<n.notes.length;c++){const[e,o]=[n.listNames[c],n.notes[c]];o.id===t&&(d=e,p={parentIds:n.notes.map((t=>t.id)),id:`${a}${(0,y.DU)(4)}`,title:o.title,body:o.body,media:o.media,addedDT:Math.min(...n.notes.map((t=>t.addedDT))),updatedDT:a}),r.push(e),i.push(o),l.push(...o.media)}const{usedFPaths:u,serverUnusedFPaths:g,localUnusedFPaths:m}=(0,y.qM)(p.media,l),w={conflictedNote:n,toListName:d,toNote:p};e({type:h.DZ,payload:w}),(0,y.Q2)(null,null,[p],b.Ay);try{await c.A.putNotes({listNames:[d],notes:[p],staticFPaths:u})}catch(I){return console.log("mergeNote error: ",I),void e({type:h.QGK,payload:{...w,error:I}})}const v=o().window.width;o().display.listName!==d&&""===o().display.queryString&&(0,y.Et)(v)&&v<f.lXt&&((0,N.Aw)(null),await(0,y.yy)(100)),e({type:h.LkF,payload:w}),await _(e,o),await et(i.map((t=>t.id)),g,m,o),e(Rt())},et=async(t,e,o,s)=>{const n=s().pendingSslts,a=(0,y.tQ)(s()),r=(0,y.ln)(s()),{toFPaths:i}=(0,y.tk)(a,r,n),l=[];if(Array.isArray(t))for(const c of t)if(Array.isArray(i[c]))for(const t of i[c]){if(t.includes(f.d91+"/"))continue;let e;e=t.endsWith(f.hxw+f.rWq)?{title:"",body:""}:"",l.push({id:t,type:f.$tn,path:t,content:e})}if(!b.Ay.syncMode.doSyncMode&&Array.isArray(e))for(const c of e)l.push({id:c,type:f.BCn,path:c,doIgnoreDoesNotExistError:!0});if(l.length>0)try{const t={values:l,isSequential:!1,nItemsForNs:f.NrX};await c.A.performFiles(t)}catch(d){console.log("cleanUpNotes error: ",d)}Array.isArray(o)&&await p.A.deleteFiles(o)},ot=()=>async(t,e)=>{if(b.Ay.syncMode.doSyncMode&&!b.Ay.runAfterFetchTask.didRun)return t(Rt()),void(b.Ay.runAfterFetchTask.didRun=!0);t(st())},st=()=>async(t,e)=>{const o=Date.now();if(o-b.Ay.randomHouseworkTasks.dt<864e5)return;const s=Math.random();t(s<.33?nt():s<.66?(0,v.n5)():ct()),b.Ay.randomHouseworkTasks.dt=o},nt=()=>async(t,e)=>{if(!e().settings.doDeleteOldNotesInTrash)return;let o=Date.now();const s=f.tA0;if(e().display.listName===s)return;const n=e().pendingSslts,a=(0,y.tQ)(e()),r=(0,y.ln)(e()),{noteMetas:i,toRootIds:l,ssltInfos:d}=(0,y.tk)(a,r,n),p=i.filter((t=>t.listName===s)),u=[],g=[],m=[],w=[];for(const c of p){const t=(0,y.ju)(c.id,l);let e=c.updatedDT;(0,y.Gv)(d[t])&&d[t].updatedDT>e&&(e=d[t].updatedDT);if((Date.now()-e)/1e3/60/60/24<=f.P$0)continue;const n=[];for(const o of c.fpaths){const{subName:t}=(0,y.X0)(o);t!==f.hxw+f.rWq&&n.push({name:t,content:""})}const a={parentIds:c.parentIds,id:c.id,title:"",body:"",media:n,addedDT:c.addedDT,updatedDT:c.updatedDT},r={...a,parentIds:[a.id],id:`deleted${o}${(0,y.DU)(4)}`,title:"",body:"",media:[],updatedDT:o,fromListName:s,fromNote:a};if(o+=1,u.push(s),g.push(a),m.push(s),w.push(r),u.length>=f.NrX)break}if(0===u.length)return;const N=g.map((t=>t.id));if(N.includes(e().display.noteId))return;b.Ay.deleteOldNotes.ids=N;let v={fromListNames:u,fromNotes:g,toListNames:m,toNotes:w};t({type:h.xgi,payload:v}),(0,y.Q2)(null,null,w,b.Ay);try{const t=await c.A.putNotes({listNames:m,notes:w,manuallyManageError:!0});v={...v,...t}}catch(k){return console.log("deleteOldNotesInTrash error: ",k),t({type:h.YYk}),void(b.Ay.deleteOldNotes.ids=null)}t({type:h.pfd,payload:v}),b.Ay.deleteOldNotes.ids=null;const I=[],A=[];for(const c of v.successNotes){I.push(c.fromNote.id);for(const{name:t}of c.fromNote.media)t.startsWith(f.d91+"/")&&A.push((0,y._$)(t))}await et(I,A,A,e),await ze(t,e),t(Rt())},at=(t,e)=>async(o,s)=>{if(t||(t=b.Ay.showNoteListMenuPopup.selectedRect),e){if(b.Ay.updateSettings.doFetch||b.Ay.syncMode.didChange)return;if(s().editor.isUploading)return;if(s().display.isEditorFocused)return b.Ay.showNoteListMenuPopup.selectedRect=t,void o(ie())}(0,N.Bt)(f.zvb,!0,t)},rt=(t,e,o)=>async(s,n)=>{const{noteId:a}=n().display;b.Ay.keyboard.height>0&&s((0,N.xj)()),s(at(null,!1)),s((0,N.PU)(a,t,e,o))},it=(t,e,o)=>async(s,n)=>{const a=n().display.noteId;if(t||(t=b.Ay.showNLIMPopup.selectedNoteId),e||(e=b.Ay.showNLIMPopup.selectedRect),o){if(b.Ay.updateSettings.doFetch||b.Ay.syncMode.didChange)return;if(t===a){if(n().editor.isUploading)return;if(n().display.isEditorFocused)return b.Ay.showNLIMPopup.selectedNoteId=t,b.Ay.showNLIMPopup.selectedRect=e,void s(le())}}s(F(t)),(0,N.Bt)(f.nm0,!0,e)},lt=(t,e,o)=>async(s,n)=>{const{noteId:a}=n().display;b.Ay.keyboard.height>0&&s((0,N.xj)()),s(it(null,null,!1)),s((0,N.PU)(a,t,e,o))},ct=()=>async(t,e)=>{const{cleanUpStaticFilesDT:o}=e().localSettings;if(!o)return;if(e().display.isEditorFocused||e().display.isEditorBusy||e().editor.isUploading)return;const s=Date.now();let n=1/(24*f.P$0*60*60*1e3)*Math.abs(s-o);n=Math.max(.01,Math.min(n,.99));if(n>Math.random()){t({type:h.NaI});try{await(async(t,e)=>{const o=e().unsavedNotes,s=e().pendingSslts,n=(0,y.tQ)(e()),a=(0,y.ln)(e()),{noteMetas:r,conflictedMetas:i,toRootIds:l}=(0,y.tk)(n,a,s),c=(0,y.O4)(r,i,l);let d=f.NrX;e().user.hubUrl===f.MbX&&(d=60);const u=[];for(const p of[...r,...i])for(const t of p.fpaths)t.includes(f.d91+"/")&&u.push((0,y._$)(t));for(const p in o){const{media:t}=o[p];for(const{name:e}of t)e.includes(f.d91+"/")&&u.push((0,y._$)(e))}if(!b.Ay.syncMode.doSyncMode){const t=(0,y.dT)(e()),o=[];for(const e of t)if(!u.includes(e)&&(o.push({id:e,type:f.BCn,path:e,doIgnoreDoesNotExistError:!0}),o.length>=d))break;o.length}const h=await p.A.getStaticFPaths(),g=[];for(const p of h)if(!u.includes(p)&&(g.push(p),g.length>=d))break;g.length>0&&await p.A.deleteFiles(g);const m=[];for(const p in o){const{id:t,title:s,body:n,savedTitle:a,savedBody:r}=o[p];if(t===f.cir||t===e().display.noteId)continue;const i=(0,y.ju)(t,l);if((0,y.Kg)(i)&&c.includes(i)||console.log("Found unsavedNote with no noteMainId",o[p]),(0,y.hB)(s,a)&&(0,y.z_)(n,r)&&(m.push(t),m.length>=d))break}m.length>0&&t((0,N.tA)(m))})(t,e),t({type:h.$UV})}catch(a){console.log("Error when clean up static files: ",a),t({type:h.kSv})}}},dt=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async(o,s)=>{if(!t){if(e){const t=s().listNameEditors,e=s().settings.listNameMap,n=(0,y.Yv)(t,e);if((0,y.Gv)(n)){for(const t in n)(0,y.Et)(n[t].blurCount)||(n[t].blurCount=0),n[t].blurCount+=1;return o(ut(n)),o(Jt(f.zrI)),void(0,N.Bt)(f.dhM,!0)}const a=s().tagNameEditors,r=s().settings.tagNameMap,i=(0,y._H)(a,r);if((0,y.Gv)(i)){for(const t in i)(0,y.Et)(i[t].blurCount)||(i[t].blurCount=0),i[t].blurCount+=1;return o(so(i)),o(Jt(f.plg)),void(0,N.Bt)(f.dhM,!0)}}o(Lt())}b.Ay.updateSettingsPopup.didCall=!0,(0,N.Bt)(f.bzM,t),t?(o($(null,!1,!1)),o(U(null,!1))):(await(0,y.yy)(250),window.location.hash.includes("stp=true")&&(console.log("Seem settings popup is still showing, force reset."),window.location.hash="",setTimeout((()=>{const t=new(n())(window.location.href,{});if("#"===t.hash){t.set("hash","");const e=t.toString();window.history.replaceState(window.history.state,"",e)}}),1)))}},pt=(t,e,o,s)=>async(n,a)=>{a().user.isUserSignedIn||t!==f.a_7||(t=f.syC);const r={};if(t&&(r.settingsViewId=t),[!0,!1].includes(e)&&(r.isSettingsSidebarShown=e),[!0,!1].includes(o)&&(r.didSettingsCloseAnimEnd=o),[!0,!1].includes(s)&&(r.didSettingsSidebarAnimEnd=s,!s)){const{updateSettingsViewIdCount:t}=a().display;r.updateSettingsViewIdCount=t+1}n({type:h.qQd,payload:r})},ut=t=>({type:h.wrC,payload:t}),ht=t=>{let e=0;const o=Date.now(),s=[];for(const n of t){const t={listName:`${o+e}-${(0,y.DU)(4)}`,displayName:n};s.push(t),e+=1}return{type:h.Cxh,payload:s}},ft=(t,e)=>({type:h._Jg,payload:{listNames:t,newNames:e}}),yt=(t,e)=>({type:h.pa_,payload:{listName:t,direction:e}}),gt=(t,e)=>({type:h.RGR,payload:{listName:t,parent:e}}),mt=(t,e)=>async(o,s)=>{const n=[e.listName];n.push(...(0,y.yP)(e.children));const a=s().pendingSslts,r=(0,y.tQ)(s()),i=(0,y.ln)(s()),{inUseListNames:l}=(0,y.tk)(r,i,a),c=[];for(const t of n)c.push(!l.includes(t));c.every((t=>!0===t))?(o(Ft(e.listName)),o(Vt(f.OcN)),(0,N.Bt)(f.atb,!0),o(ut({[t]:{msg:"",isCheckingCanDelete:!1}}))):o(ut({[t]:{msg:f.iMY[f.pFv],isCheckingCanDelete:!1}}))},wt=t=>async(e,o)=>{const{listNameMap:s}=o().settings,n=[];for(const a of t){const{listNameObj:t}=(0,y.$L)(a,s);n.push(t.listName),n.push(...(0,y.yP)(t.children))}e({type:h.AnK,payload:{listNames:n}})},bt=t=>({type:h.iCO,payload:t}),Nt=t=>({type:h.NBY,payload:t}),vt=t=>({type:h.NA5,payload:t}),It=t=>({type:h.TiZ,payload:t}),At=t=>({type:h.MTP,payload:t}),kt=t=>({type:h.C_M,payload:t}),St=(t,e,o)=>async(s,n)=>{const a=n().info.purchases;if(!(0,y.ER)(a))return s(he(f.u6O)),void s((0,N.e5)(f.oPm,!0));const r={};f.ZSJ.includes(t)&&(r.noteDateFormat=t),[!0,!1].includes(e)&&(r.noteDateIsTwoDigit=e),[!0,!1].includes(o)&&(r.noteDateIsCurrentYearShown=o),s({type:h.OUI,payload:r})},Pt=t=>async(e,o)=>{const s=o().info.purchases;if(!(0,y.ER)(s))return e(he(f.Epr)),void e((0,N.e5)(f.oPm,!0));e({type:h.XEn,payload:t})},Mt=t=>async(e,o)=>{const s=o().info.purchases;if(!(0,y.ER)(s))return e(he(f.CpX)),void e((0,N.e5)(f.oPm,!0));e({type:h.FW6,payload:t})},Ft=t=>({type:h.ceb,payload:t}),Dt=async(t,e)=>{const o=e().settings;t({type:h.Eqk,payload:{settings:o}});const s=((t,e)=>async()=>{const o=e().settings,s=e().snapshot.settings,{doSyncMode:n,doSyncModeInput:a}=e().localSettings;if(n!==a&&(b.Ay.syncMode.didChange=!0),(0,y.n4)(o,s))return void t({type:h.A2z});const r=Date.now(),{fpaths:i,ids:l}=(0,y.qO)((0,y.Gi)(e())),d=(0,y.Cd)(`${r}${(0,y.DU)(4)}`,l),p=(0,y.BK)(d);let u=o.sortOn!==s.sortOn||o.doDescendingOrder!==s.doDescendingOrder;b.Ay.syncMode.didChange&&(u=!1);const f={settings:o,doFetch:u};b.Ay.updateSettings.doFetch=u,t({type:h.E5W,payload:f});try{await c.A.putSettings({settingsFPaths:[p],settingsContents:[o]})}catch(g){return console.log("updateSettings error: ",g),t({type:h.fjx,payload:{...f,error:g}}),t({type:h.FRL}),b.Ay.updateSettings.doFetch=!1,void(b.Ay.syncMode.didChange=!1)}t({type:h.ArM,payload:f}),t({type:h.MIu}),b.Ay.updateSettings.doFetch=!1,await xt(i),await ze(t,e),await Qt()(t,e)})(t,e);s[f.h66]=h.E5W,N.rK.push(s)},xt=async t=>{if(0!==t.length)try{await c.A.putSettings({settingsFPaths:t,settingsContents:t.map((()=>({})))})}catch(e){console.log("cleanUpSettings error: ",e)}},Et=async(t,e)=>{t({type:h.DI1});const o=((t,e)=>async()=>{const o=e().info,s=e().snapshot.info;if((0,y.n4)(o,s))return void t({type:h.JPl});const n=Date.now(),a=`${f.rDG}${n}${f.rWq}`,r=(0,y.OW)(e()),i={infoFPath:a,info:o};t({type:h.zdc,payload:i});try{await c.A.putInfos({infoFPaths:[a],infos:[o]})}catch(l){return console.log("updateInfo error: ",l),t({type:h.CZj,payload:{...i,error:l}}),void t({type:h.kHo})}t({type:h.Bdy,payload:i}),t({type:h.JGn}),(0,y.Kg)(r)&&await Ct([r]),await Qt()(t,e)})(t,e);o[f.h66]=h.zdc,N.rK.push(o)},Ct=async t=>{if(0!==t.length)try{await c.A.deleteInfos({infoFPaths:t})}catch(e){console.log("updateInfo clean up error: ",e)}},Tt=async(t,e)=>{const o=((t,e)=>async()=>{if(!b.Ay.syncMode.didChange)return;b.Ay.syncMode.didChange=!1;const{doSyncMode:t,doSyncModeInput:o}=e().localSettings;if(t===o)return;const s=await l.A.getLocalSettings();s.doSyncMode=s.doSyncModeInput,await l.A.putLocalSettings(s),b.Ay.syncMode.didReload=!0,window.location.reload()})(0,e);o[f.h66]="APPLY_SYNC_MODE",N.rK.push(o)},Lt=()=>async(t,e)=>{await Dt(t,e),await Et(t,e),await Tt(0,e)},$t=()=>async(t,e)=>{await Dt(t,e),await Tt(0,e)},Ot=()=>async(t,e)=>{const o=e().settings,s=e().snapshot.settings,n=e().pendingSslts,a=e().pendingTags,r=(0,y.tQ)(e()),i=(0,y.ln)(e()),l=(0,y.x$)(e()),{noteMetas:c,conflictedMetas:d,toRootIds:p,inUseListNames:u}=(0,y.tk)(r,i,n),f=u,g=(0,y.Vr)(c,d,p,l,a);let m=o.sortOn!==s.sortOn||o.doDescendingOrder!==s.doDescendingOrder;b.Ay.syncMode.didChange&&(m=!1);const w={listNames:f,tagNames:g,settings:s,doFetch:m};b.Ay.updateSettings.doFetch=m,t({type:h.Kxg,payload:w}),b.Ay.updateSettings.doFetch=!1},jt=()=>async(t,e)=>{const o=await l.A.getLocalSettings();o.doSyncMode=!1,o.doSyncModeInput=!1,await l.A.putLocalSettings(o),window.location.reload()},Ut=()=>({type:h.Av5}),_t=()=>async(t,e)=>{e().display.isSettingsPopupShown||await Et(t,e)},Bt=t=>async(e,o)=>{const s=o().settings,n=o().conflictedSettings.contents,a=Date.now(),r=n.map((t=>t.fpath)),i=n.map((t=>t.id)),l=n.find((e=>e.id===t)),d=(0,y.Cd)(`${a}${(0,y.DU)(4)}`,i),p=(0,y.BK)(d),u={...w.ji};for(const t in u)t in l&&(u[t]=l[t]);const g=o().pendingSslts,m=o().pendingTags,v=(0,y.tQ)(o()),I=(0,y.ln)(o()),A=(0,y.x$)(o()),{noteMetas:k,conflictedMetas:S,toRootIds:P,inUseListNames:M}=(0,y.tk)(v,I,g),F=M,D=(0,y.Vr)(k,S,P,A,m),x=u.sortOn!==s.sortOn||u.doDescendingOrder!==s.doDescendingOrder,E={listNames:F,tagNames:D,settings:u,doFetch:x};b.Ay.updateSettings.doFetch=x,e({type:h.pOK,payload:E});const C=((t,e,o,s,n,a)=>async()=>{try{await c.A.putSettings({settingsFPaths:[t],settingsContents:[e]})}catch(r){return console.log("mergeSettings error: ",r),n({type:h.UkJ,payload:{...s,error:r}}),void(b.Ay.updateSettings.doFetch=!1)}n({type:h.tfv,payload:s}),b.Ay.updateSettings.doFetch=!1,await xt(o),await Qt()(n,a)})(p,u,r,E,e,o);C[f.h66]=h.pOK,N.rK.push(C)},qt=(t,e,o,s,n)=>async()=>{if(!n().user.isUserSignedIn||!b.Ay.syncMode.doSyncMode||b.Ay.deleteSyncData.isDeleting)return void(t&&t(!0));let a=!1;const r=n().display.syncProgress;r&&r.status===f.X__&&(a=!0),s({type:h.a9S}),await(0,y.yy)(16);try{const{noteFPaths:n,ssltFPaths:r,staticFPaths:i,settingsFPaths:l,infoFPath:u,pinFPaths:g,tagFPaths:m}=await c.A.listServerFPaths(e),{noteMetas:w,conflictedMetas:v}=(0,y.tk)(n,r,{}),I=[];for(const t of w)I.push(...t.fpaths);for(const t of v)I.push(...t.fpaths);const{noteFPaths:A,ssltFPaths:k,settingsFPaths:S,infoFPath:P,pinFPaths:M,tagFPaths:F}=await c.A.listFPaths(e),D=await p.A.getStaticFPaths(),{noteMetas:x,conflictedMetas:E}=(0,y.tk)(A,k,{}),C=[];for(const t of x)C.push(...t.fpaths);for(const t of E)C.push(...t.fpaths);const T=[...new Set([...n,...A])],L=[...new Set([...r,...k])],{noteMetas:$,conflictedMetas:O,toRootIds:j,ssltInfos:U}=(0,y.tk)(T,L,{}),_=[];for(const t of $)_.push(...t.fpaths);for(const t of O)_.push(...t.fpaths);const B=[];for(const t of _)t.includes(f.d91+"/")&&B.push((0,y._$)(t));const q=(0,y.O4)($,O,j);let R=[],Q=[],G=[],z=[],X=[];for(const t of A){if(t.includes(f.d91+"/")){const e=(0,y._$)(t);if(B.includes(e)&&!i.includes(e))if(b.Ay.platform.isReactNative){const t="file://"+e;R.includes(t)||(R.push(t),Q.push({id:t,type:f.$tn,path:t,content:""}))}else if(!R.includes(e)){R.push(e);const t=await p.A.getFile(e);void 0!==t&&Q.push({id:e,type:f.$tn,path:e,content:t})}}if(!n.includes(t)){if(R.push(t),_.includes(t))if(t.includes(f.d91+"/"))G.push({id:t,type:f.$tn,path:t,content:""});else{const e=(await c.A.getFiles([t])).contents[0];z.push({id:t,type:f.$tn,path:t,content:e})}else if(t.endsWith(f.hxw+f.rWq)){const e={title:"",body:""};G.push({id:t,type:f.$tn,path:t,content:e})}else G.push({id:t,type:f.$tn,path:t,content:""});[Q,G,z,X]=await(0,y._y)(d.A.performFiles,Q,G,z,X)}}R=[];for(const t of I){if(t.includes(f.d91+"/")){const e=(0,y._$)(t);if(!B.includes(e)&&i.includes(e)&&!R.includes(e)){R.push(e);const t={id:e,type:f.BCn,path:e,doIgnoreDoesNotExistError:!0};X.push(t)}}if(!_.includes(t)&&!t.includes(f.d91+"/")){if(t.endsWith(f.hxw+f.rWq)){const e={title:"",body:""};G.push({id:t,type:f.$tn,path:t,content:e})}else G.push({id:t,type:f.$tn,path:t,content:""});[Q,G,z,X]=await(0,y._y)(d.A.performFiles,Q,G,z,X)}}let K=[],W=[],V=[],J=[],Y=[],H=[];for(const t of n){if(t.includes(f.d91+"/")){const e=(0,y._$)(t);if(B.includes(e)&&!D.includes(e))if(b.Ay.platform.isReactNative){const t="file://"+e;W.includes(t)||(W.push(t),a=!0)}else W.includes(e)||(W.push(e),a=!0)}if(!A.includes(t))if(a=!0,_.includes(t))t.includes(f.d91+"/")?J.push({id:t,type:f.$tn,path:t,content:""}):K.push(t);else{if(t.endsWith(f.hxw+f.rWq)){const e={title:"",body:""};J.push({id:t,type:f.$tn,path:t,content:e})}else J.push({id:t,type:f.$tn,path:t,content:""});[V,J,Y,H]=await(0,y._y)(c.A.performFiles,V,J,Y,H)}}if(b.Ay.platform.isReactNative)await d.A.getFiles(W,!0);else for(let t=0;t<W.length;t+=f.NrX){const e=W.slice(t,t+f.NrX),o=await d.A.getFiles(e,!0);for(const{fpath:t,content:s}of o.responses)null!==s&&await p.A.putFile(t,s)}for(let t=0;t<K.length;t+=f.NrX){const e=K.slice(t,t+f.NrX),o=await d.A.getFiles(e);for(const{fpath:t,content:s}of o.responses)Y.push({id:t,type:f.$tn,path:t,content:s});[V,J,Y,H]=await(0,y._y)(c.A.performFiles,V,J,Y,H)}R=[];for(const t of C){if(t.includes(f.d91+"/")){const e=(0,y._$)(t);!B.includes(e)&&D.includes(e)&&(R.includes(e)||R.push(e))}if(!_.includes(t)&&!t.includes(f.d91+"/")){if(t.endsWith(f.hxw+f.rWq)){const e={title:"",body:""};J.push({id:t,type:f.$tn,path:t,content:e})}else J.push({id:t,type:f.$tn,path:t,content:""});[V,J,Y,H]=await(0,y._y)(c.A.performFiles,V,J,Y,H)}}await p.A.deleteFiles(R);const Z=[];for(const t in U)q.includes(t)&&Z.push(U[t].fpath);for(const t of Z)r.includes(t)||G.push({id:t,type:f.$tn,path:t,content:{}});for(const t of r)Z.includes(t)||X.push({id:t,type:f.BCn,path:t,doIgnoreDoesNotExistError:!0});[Q,G,z,X]=await(0,y._y)(d.A.performFiles,Q,G,z,X);for(const t of Z)k.includes(t)||(a=!0,J.push({id:t,type:f.$tn,path:t,content:{}}));for(const t of k)Z.includes(t)||H.push({id:t,type:f.BCn,path:t,doIgnoreDoesNotExistError:!0});[V,J,Y,H]=await(0,y._y)(c.A.performFiles,V,J,Y,H);const{fpaths:tt}=(0,y.qO)(l),{fpaths:et}=(0,y.qO)(S),ot=[...new Set([...l,...S])],{fpaths:st}=(0,y.qO)(ot);for(const t of S){if(l.includes(t))continue;let e;st.includes(t)?(e=(await c.A.getFiles([t])).contents[0],z.push({id:t,type:f.$tn,path:t,content:e})):(e={},G.push({id:t,type:f.$tn,path:t,content:e}))}for(const t of tt)st.includes(t)||G.push({id:t,type:f.$tn,path:t,content:{}});[Q,G,z,X]=await(0,y._y)(d.A.performFiles,Q,G,z,X),K=[];for(const t of l)S.includes(t)||(a=!0,st.includes(t)?K.push(t):J.push({id:t,type:f.$tn,path:t,content:{}}));for(let t=0;t<K.length;t+=f.NrX){const e=K.slice(t,t+f.NrX),o=await d.A.getFiles(e);for(const{fpath:t,content:s}of o.responses)Y.push({id:t,type:f.$tn,path:t,content:s})}for(const t of et)st.includes(t)||J.push({id:t,type:f.$tn,path:t,content:{}});let nt;if([V,J,Y,H]=await(0,y._y)(c.A.performFiles,V,J,Y,H),u&&P){const t=parseInt(u.slice(f.rDG.length,-1*f.rWq.length),10),e=parseInt(P.slice(f.rDG.length,-1*f.rWq.length),10);nt=t>e?1:t<e?2:0}else nt=u?1:P?2:0;if(0===nt);else if(1===nt){const t=(await d.A.getFiles([u])).contents[0];if(Y.push({id:u,type:f.$tn,path:u,content:t}),P){const t={id:P,type:f.BCn,path:P,doIgnoreDoesNotExistError:!1};H.push(t)}a=!0,[V,J,Y,H]=await(0,y._y)(c.A.performFiles,V,J,Y,H)}else{if(2!==nt)throw new Error(`Invalid syncInfoAction: ${nt}`);{const t=(await c.A.getFiles([P])).contents[0];if(z.push({id:P,type:f.$tn,path:P,content:t}),u){const t={id:u,type:f.BCn,path:u,doIgnoreDoesNotExistError:!0};X.push(t)}[Q,G,z,X]=await(0,y._y)(d.A.performFiles,Q,G,z,X)}}const at=[...new Set([...g,...M])],rt=(0,y.Tu)(at,j),it=[];for(const t in rt)q.includes(t)&&it.push(rt[t].fpath);for(const t of it)g.includes(t)||G.push({id:t,type:f.$tn,path:t,content:{}});for(const t of g)it.includes(t)||X.push({id:t,type:f.BCn,path:t,doIgnoreDoesNotExistError:!0});[Q,G,z,X]=await(0,y._y)(d.A.performFiles,Q,G,z,X);for(const t of it)M.includes(t)||(a=!0,J.push({id:t,type:f.$tn,path:t,content:{}}));for(const t of M)it.includes(t)||H.push({id:t,type:f.BCn,path:t,doIgnoreDoesNotExistError:!0});[V,J,Y,H]=await(0,y._y)(c.A.performFiles,V,J,Y,H);const lt=[...new Set([...m,...F])],ct=(0,y._3)(lt,j),dt=[];for(const t in ct)if(q.includes(t))for(const e of ct[t].values)dt.push(e.fpath);for(const t of dt)m.includes(t)||G.push({id:t,type:f.$tn,path:t,content:{}});for(const t of m)dt.includes(t)||X.push({id:t,type:f.BCn,path:t,doIgnoreDoesNotExistError:!0});[Q,G,z,X]=await(0,y._y)(d.A.performFiles,Q,G,z,X,f.NrX,!0);for(const t of dt)F.includes(t)||(a=!0,J.push({id:t,type:f.$tn,path:t,content:{}}));for(const t of F)dt.includes(t)||H.push({id:t,type:f.BCn,path:t,doIgnoreDoesNotExistError:!0});[V,J,Y,H]=await(0,y._y)(c.A.performFiles,V,J,Y,H,f.NrX,!0),N.$R.length<=1?s({type:h.O$h,payload:{updateAction:o,haveUpdate:a}}):(o<b.Ay.sync.updateAction&&(b.Ay.sync.updateAction=o),a&&(b.Ay.sync.haveUpdate=a)),t&&t(!0),b.Ay.sync.lastSyncDT=Date.now()}catch(i){console.log("Sync error: ",i),o<b.Ay.sync.updateAction&&(b.Ay.sync.updateAction=o),a&&(b.Ay.sync.haveUpdate=a);const e=n().localSettings.signInDT;s({type:h.xNy,payload:{error:i,signInDT:e}}),t&&t(!1)}},Rt=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return async(o,s)=>{if(N.$R.length>=7)return void console.log("Sync queue length is too high:",N.$R.length);if(N.$R.length>=2){let o=!1,s=!1;t||(o=!0),0===e&&(s=!0);for(const t of N.$R.jobs)t[f.UHN]&&(o=!0),t[f.jwo]<=e&&(s=!0);if(o&&s)return}const n=qt(null,t,e,o,s);n[f.UHN]=t,n[f.jwo]=e,N.$R.push(n)}},Qt=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return async(o,s)=>{if(N.$R.length>=7)return console.log("Sync queue length is too high:",N.$R.length),!1;const n=new Promise((n=>{const a=qt(n,t,e,o,s);a[f.UHN]=t,a[f.jwo]=e,N.$R.push(a)}));return await n}},Gt=(t,e)=>async(o,s)=>{if(o(A()),b.Ay.sync.updateAction<t&&(t=b.Ay.sync.updateAction),e||(e=b.Ay.sync.haveUpdate),[b.Ay.sync.updateAction,b.Ay.sync.haveUpdate]=[1/0,!1],2===t)return;if(1===t)return void o(zt());if(!e)return void o(st());if(!s().display.isBulkEditing){const t=b.Ay.scrollPanel.scrollY,e=s().display.noteId,n=s().display.isNoteListItemMenuPopupShown||s().display.isListNamesPopupShown||s().display.isPinMenuPopupShown||s().display.isLockMenuPopupShown,a=s().display.isEditorFocused,r=s().display.isEditorBusy;if(0===t&&null===e&&!n&&!a&&!r)return void o(zt())}o({type:h.iQX,payload:{status:f.X__}})},zt=()=>({type:h.JFm}),Xt=t=>({type:h.apx,payload:t}),Kt=t=>({type:h.ETs,payload:t}),Wt=t=>({type:h.zAS,payload:t}),Vt=t=>({type:h.tu7,payload:t}),Jt=t=>({type:h.w5y,payload:t}),Yt=t=>({type:h.c1h,payload:{listNamesMode:t}}),Ht=t=>({type:h.Rt0,payload:{sidebarListNamesMode:t}}),Zt=()=>({type:h.qoP}),te=()=>({type:h.tw4}),ee=()=>({type:h.RP7}),oe=()=>({type:h.CUJ}),se=()=>({type:h.h9U}),ne=()=>({type:h.IIT}),ae=()=>({type:h.I_e}),re=()=>({type:h.WI0}),ie=()=>({type:h.M1P}),le=()=>({type:h.l2v}),ce=()=>({type:h.fwC}),de=t=>({type:h.xEY,payload:t}),pe=t=>({type:h.aZK,payload:t}),ue=(t,e,o,s)=>async(n,a)=>{const r=t===f.cir?f.E7W:(0,y.vW)(t,a().notes);(0,y.Gv)(r)&&n({type:h.Irp,payload:{id:t,title:e,body:o,media:s,savedTitle:r.title,savedBody:r.body,savedMedia:r.media}})},he=t=>({type:h.EFP,payload:t}),fe=t=>async(e,o)=>{const s=o().info.purchases;if(!(0,y.ER)(s))return e(he(f.ft2)),void e((0,N.e5)(f.oPm,!0));const n=o().pendingSslts,r=o().pendingPins,i=(0,y.tQ)(o()),l=(0,y.ln)(o()),c=(0,y.w5)(o()),{toRootIds:d}=(0,y.tk)(i,l,n),p=(0,y.L)(c,r,!0,d),u=Object.values(p).map((t=>t.rank)).sort();let h;if(u.length>0){const t=u[u.length-1];h=a.X.parse(`0|${t.replace("_",":")}`).genNext()}else h=a.X.middle();let g=Date.now();const m=[];for(const a of t){const t=(0,y.ju)(a,d);if((0,y.Gv)(p[t]))continue;const e=h.toString().slice(2).replace(":","_");m.push({rank:e,updatedDT:g,addedDT:g,id:a}),h=h.genNext(),g+=1}0!==m.length&&await ye(m,e,o)},ye=async(t,e,o)=>{let s={pins:t};e({type:h.dKt,payload:s}),await _(e,o);try{const t=await c.A.putPins(s);s={...s,...t}}catch(n){return console.log("pinNotes error: ",n),void e({type:h.SlQ,payload:{...s,error:n}})}e({type:h.n45,payload:s})},ge=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async(o,s)=>{const n=s().pendingSslts,a=s().pendingPins,r=(0,y.tQ)(s()),i=(0,y.ln)(s()),l=(0,y.w5)(s()),{toRootIds:c}=(0,y.tk)(r,i,n),d=(0,y.L)(l,a,!0,c);let p=Date.now();const u=[];for(const e of t){const t=(0,y.ju)(e,c);if(d[t]){const{rank:e,addedDT:o,id:s}=d[t];u.push({rank:e,updatedDT:p,addedDT:o,id:s}),p+=1}}if(0===u.length)return console.log("In unpinNotes, no pin found for ids: ",t),void(e&&o(Rt()));await me(u,o,s)}},me=async(t,e,o)=>{let s={pins:t};e({type:h.IGu,payload:s}),await _(e,o);try{const t=await c.A.deletePins(s);s={...s,...t}}catch(n){return console.log("unpinNotes error: ",n),void e({type:h.Ffe,payload:{...s,error:n}})}e({type:h.qX4,payload:s})},we=(t,e)=>async(o,s)=>{const n=s().notes,r=s().display.showingNoteInfos,i=s().pendingSslts,l=s().pendingPins,c=(0,y.tQ)(s()),d=(0,y.ln)(s()),p=(0,y.w5)(s());if(!Array.isArray(r))return void console.log("In movePinnedNote, no showingNoteInfos found for note id: ",t);const{toRootIds:u}=(0,y.tk)(c,d,i),h=[];for(const t of r){if(t.id.startsWith("conflict"))continue;const e=(0,y.vW)(t.id,n);(0,y.Gv)(e)&&f.VRb.includes(e.status)&&h.push(e)}const[g]=(0,y.CM)(h,p,l,u,(t=>(0,y.ju)(t.id,u))),m=g.findIndex((e=>e.value.id===t));if(m<0)return void console.log("In movePinnedNote, no pin found for note id: ",t);let w;if(e===f.KxA){if(0===m)return;if(1===m){const t=g[m-1].pin.rank;w=a.X.parse(`0|${t.replace("_",":")}`).genPrev().toString()}else{const t=g[m-1].pin.rank,e=g[m-2].pin.rank,o=a.X.parse(`0|${t.replace("_",":")}`),s=a.X.parse(`0|${e.replace("_",":")}`);w=t===e?s.toString():s.between(o).toString()}}else{if(e!==f.JlW)throw new Error(`Invalid direction: ${e}`);if(m===g.length-1)return;if(m===g.length-2){const t=g[m+1].pin.rank;w=a.X.parse(`0|${t.replace("_",":")}`).genNext().toString()}else{const t=g[m+1].pin.rank,e=g[m+2].pin.rank,o=a.X.parse(`0|${t.replace("_",":")}`),s=a.X.parse(`0|${e.replace("_",":")}`);w=t===e?o.toString():o.between(s).toString()}}w=w.slice(2).replace(":","_");const b=Date.now(),{addedDT:N}=g[m].pin,v={rank:w,updatedDT:b,addedDT:N,id:t};await be(v,o,s)},be=async(t,e,o)=>{let s={...t};e({type:h.KU5,payload:s}),await _(e,o);try{const t=await c.A.putPins({pins:[s]});s={...s,...t}}catch(n){return console.log("movePinnedNote error: ",n),void e({type:h.Pvt,payload:{...s,error:n}})}e({type:h.gTQ,payload:s})},Ne=()=>async(t,e)=>{const o=e().pendingPins,s=[],n=[],a=[];for(const r in o){const t=o[r],[e,i]=[t.status,(0,y.wg)(t,[f.XQv])];e===h.SlQ?s.push(i):e===h.Ffe?n.push(i):e===h.Pvt&&a.push(i)}if(s.length>0&&await ye(s,t,e),n.length>0&&await me(n,t,e),a.length>0)for(const r of a)await be(r,t,e)},ve=()=>async(t,e)=>{t({type:h.tZG}),await _(t,e)},Ie=()=>async(t,e)=>{const o=e().pendingSslts,s=(0,y.tQ)(e()),n=(0,y.ln)(e()),a=(0,y.w5)(e()),{noteMetas:r,conflictedMetas:i,toRootIds:l}=(0,y.tk)(s,n,o),d=(0,y.O4)(r,i,l),p=(0,y.Tu)(a,l);let u=f.NrX;e().user.hubUrl===f.MbX&&(u=60);const h=[];for(const c of a){const{id:t}=(0,y.AI)(c),e=t.startsWith("deleted")?t.slice(7):t,o=(0,y.ju)(e,l);if((!(0,y.Kg)(o)||!d.includes(o)||!(0,y.Gv)(p[o])||p[o].fpath!==c)&&(h.push({id:c,type:f.BCn,path:c,doIgnoreDoesNotExistError:!0}),h.length>=u))break}if(h.length>0)try{const t={values:h,isSequential:!1,nItemsForNs:f.NrX};await c.A.performFiles(t)}catch(g){console.log("cleanUpPins error: ",g)}t(Rt())},Ae=t=>async(e,o)=>{if(0===t.length)return;o().display.isBulkEditing&&(0,N.RW)(!1),await fe(t)(e,o)},ke=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async(o,s)=>{if(0===t.length)return;s().display.isBulkEditing&&(0,N.RW)(!1),await ge(t,e)(o,s)}},Se=t=>({type:h.yR8,payload:t}),Pe=(t,e)=>async(o,s)=>{const n=s().info.purchases;if(!(0,y.ER)(n))return o(he(f.WIc)),void o((0,N.e5)(f.oPm,!0));o({type:s().localSettings.doUseLocalTheme?h.Eoz:h.wBS,payload:{mode:t,customOptions:e}})},Me=t=>async(e,o)=>{const s=o().localSettings.doUseLocalTheme?o().localSettings.themeCustomOptions:o().settings.themeCustomOptions,n=o().window.is24HFormat;let a;for(const c of s)if(c.mode===t){a=c;break}if(!a)return;const{hour:r,minute:i,period:l}=(0,y.m8)(a.startTime,n);e({type:h.hwi,payload:{updatingThemeMode:t,hour:r,minute:i,period:l}})},Fe=(t,e,o)=>{const s={};return(0,y.Kg)(t)&&t.length>0&&(s.hour=t),(0,y.Kg)(e)&&e.length>0&&(s.minute=e),["AM","PM"].includes(o)&&(s.period=o),{type:h.qKN,payload:s}},De=()=>async(t,e)=>{const o=e().localSettings.doUseLocalTheme?e().localSettings.themeCustomOptions:e().settings.themeCustomOptions,{updatingThemeMode:s,hour:n,minute:a,period:r}=e().timePick,i=f.yAf,l=[];let c;for(const p of o)p.mode===s?c=p:l.push({...p});if(!c)return;const d=(0,y.__)(n,a,r);l.push({...c,startTime:d}),t(Pe(i,l))},xe=()=>async(t,e)=>{const o=window.open(),s=e().notes,n=e().display.selectingNoteId,a=(0,y.vW)(n,s);if(!(0,y.Gv)(a))return void console.log("In viewNoteAsWebpage, invalid selectingNoteId:",n);const r=await(async t=>{const e=[];for(const o of t.matchAll(/<img[^>]+?src="([^"]+)"[^>]*>/gi)){const t=o[1];t.startsWith(f.d91+"/")&&e.push(t)}for(const o of e){let e=await p.A.getFile(o);if((0,g.mg)(e)&&(e=new Blob([e])),(0,g.qf)(e)){const s=await(0,g.Jd)(e);t=t.replace(o,s)}}return t})(a.body);let i=`${I}`;i=i.replace(/__-title-__/g,a.title),i=i.replace(/__-body-__/g,r),i=i.replace(' mx-12 my-16"','"'),o.document.write(i),o.document.close()},Ee=t=>({type:h.D5P,payload:t}),Ce=t=>({type:h.Cr3,payload:t}),Te=t=>async(e,o)=>{const s=o().info.purchases;if(!(0,y.ER)(s))return t===f.Ecf?(0,N.Bt)(f.nm0,!1,null):t===f.UIS&&(0,N.Bt)(f.J06,!1,null),e(he(f.jpi)),void e((0,N.e5)(f.oPm,!0));e(Ee(t)),(0,N.Bt)(f.bcx,!0,null,!0)},Le=(t,e,o,s)=>async(n,a)=>{const r=(0,y.Oj)(e);if(r!==f.VjV)return void n(Ce({errMsg:f.T61[r]}));n(Ce({isLoadingShown:!0,errMsg:""})),await(0,y.yy)(16);const i=a().pendingSslts,l=(0,y.tQ)(a()),c=(0,y.ln)(a()),{toRootIds:d}=(0,y.tk)(l,c,i),p=(0,y.ju)(t,d);e=await u.A.encrypt(e),n({type:h.POf,payload:{noteId:t,noteMainId:p,password:e,doShowTitle:o,canExport:s}}),(0,N.Bt)(f.bcx,!1,null)},$e=(t,e)=>async(o,s)=>{b.Ay.updateSettings.doFetch||b.Ay.syncMode.didChange||(o(F(t)),(0,N.Bt)(f.vJq,!0,e))},Oe=(t,e)=>async(o,s)=>{const n=(0,y.Oj)(e);if(n!==f.VjV)return void o(Ce({errMsg:f.T61[n]}));o(Ce({isLoadingShown:!0,errMsg:""})),await(0,y.yy)(16);const a=s().pendingSslts,r=(0,y.tQ)(s()),i=(0,y.ln)(s()),{toRootIds:l}=(0,y.tk)(r,i,a),c=(0,y.ju)(t,l),d=s().lockSettings.lockedNotes[c];let p=!1;if((0,y.Gv)(d)&&(0,y.Kg)(d.password)){await u.A.decrypt(d.password)===e&&(p=!0)}p?(o({type:h.YaX,payload:{noteMainId:c}}),(0,N.Bt)(f.bcx,!1,null)):o(Ce({isLoadingShown:!1,errMsg:"Password is not correct. Please try again."}))},je=t=>async(e,o)=>{const s=o().pendingSslts,n=(0,y.tQ)(o()),a=(0,y.ln)(o()),{toRootIds:r}=(0,y.tk)(n,a,s),i=(0,y.ju)(t,r);e({type:h.PQg,payload:{noteId:t,noteMainId:i}})},Ue=(t,e)=>async(o,s)=>{if(t||(t=b.Ay.showUNEPopup.selectedNoteId),e){if(b.Ay.updateSettings.doFetch||b.Ay.syncMode.didChange)return;if(b.Ay.deleteOldNotes.ids&&b.Ay.deleteOldNotes.ids.includes(t))return;if(s().editor.isUploading)return;if(s().display.isEditorFocused)return b.Ay.showUNEPopup.selectedNoteId=t,void o(ce())}o(F(t)),o(Ee(f.XU4)),(0,N.Bt)(f.bcx,!0)},_e=(t,e,o)=>async(s,n)=>{const{noteId:a}=n().display;b.Ay.keyboard.height>0&&s((0,N.xj)()),s(Ue(null,!1)),s((0,N.PU)(a,t,e,o))},Be=(t,e)=>async(o,s)=>{const n=(0,y.Oj)(e);if(n!==f.VjV)return void o(Ce({errMsg:f.T61[n]}));o(Ce({isLoadingShown:!0,errMsg:""})),await(0,y.yy)(16);const a=s().pendingSslts,r=(0,y.tQ)(s()),i=(0,y.ln)(s()),{toRootIds:l}=(0,y.tk)(r,i,a),c=(0,y.ju)(t,l),d=s().lockSettings.lockedNotes[c];let p=!1;if((0,y.Gv)(d)&&(0,y.Kg)(d.password)){await u.A.decrypt(d.password)===e&&(p=!0)}if(!p)return void o(Ce({isLoadingShown:!1,errMsg:"Password is not correct. Please try again."}));o({type:h.Uys,payload:{noteMainId:c,unlockedDT:Date.now()}}),(0,N.Bt)(f.bcx,!1,null);const g=s().window.width;(0,y.Et)(g)&&g<f.lXt?setTimeout((()=>{(0,N.Aw)(t)}),100):o((0,N.RY)(t))},qe=(t,e,o,s)=>async(n,a)=>{const r=(0,y.Oj)(e);r===f.VjV?(n(Ce({isLoadingShown:!0,errMsg:""})),await(0,y.yy)(16),e=await u.A.encrypt(e),n({type:h.biW,payload:{listName:t,password:e,canChangeListNames:o,canExport:s}}),(0,N.Bt)(f.bcx,!1,null)):n(Ce({errMsg:f.T61[r]}))},Re=(t,e)=>async(o,s)=>{const n=(0,y.Oj)(e);if(n!==f.VjV)return void o(Ce({errMsg:f.T61[n]}));o(Ce({isLoadingShown:!0,errMsg:""})),await(0,y.yy)(16);const a=s().lockSettings.lockedLists[t];let r=!1;if((0,y.Gv)(a)&&(0,y.Kg)(a.password)){await u.A.decrypt(a.password)===e&&(r=!0)}r?(o({type:h.adq,payload:{listName:t}}),(0,N.Bt)(f.bcx,!1,null)):o(Ce({isLoadingShown:!1,errMsg:"Password is not correct. Please try again."}))},Qe=()=>async(t,e)=>{const o=e().display.listName;t({type:h.V9c,payload:{listName:o}})},Ge=(t,e)=>async(o,s)=>{const n=(0,y.Oj)(e);if(n!==f.VjV)return void o(Ce({errMsg:f.T61[n]}));o(Ce({isLoadingShown:!0,errMsg:""})),await(0,y.yy)(16);const a=s().lockSettings.lockedLists[t];let r=!1;if((0,y.Gv)(a)&&(0,y.Kg)(a.password)){await u.A.decrypt(a.password)===e&&(r=!0)}r?(o({type:h._3$,payload:{listName:t,unlockedDT:Date.now()}}),(0,N.Bt)(f.bcx,!1,null)):o(Ce({isLoadingShown:!1,errMsg:"Password is not correct. Please try again."}))},ze=async(t,e)=>{const{listNameMap:o}=e().settings,s=e().lockSettings,n=e().pendingSslts,a=(0,y.tQ)(e()),r=(0,y.ln)(e()),{toLeafIds:i}=(0,y.tk)(a,r,n),l=[];for(const d in s.lockedNotes)Array.isArray(i[d])||l.push(d);const c=[];for(const d in s.lockedLists)(0,y.fm)(d,o)||c.push(d);0===l.length&&0===c.length||t({type:h.ZQO,payload:{noteMainIds:l,listNames:c}})},Xe=(t,e)=>{const[o,s]=[Array.isArray(t),Array.isArray(e)];if(!o&&!s)return!1;if(!o||!s)return!0;if(t.length!==e.length)return!0;for(let n=0;n<t.length;n++){const[o,s]=[t[n],e[n]];if(o.tagName!==s.tagName)return!0}return!1},Ke=(t,e)=>async(o,s)=>{if(t){if(e){const t=s().info.purchases;if(!(0,y.ER)(t))return s().display.isNoteListItemMenuPopupShown&&(0,N.Bt)(f.nm0,!1,null),s().display.isBulkEditMenuPopupShown&&(0,N.Bt)(f.bL,!1,null),o(he(f.Mc0)),void o((0,N.e5)(f.oPm,!0))}const t=(t=>{const e=(0,y.tQ)(t()),o=(0,y.ln)(t()),s=(0,y.x$)(t()),n=t().pendingSslts,a=t().pendingTags,r=t().settings.tagNameMap,i=t().display.selectingNoteId,l=t().display.isBulkEditing,c=t().display.selectedNoteIds,{toRootIds:d}=(0,y.tk)(e,o,n),p={...w.bN};let u;if(l){if(0===c.length)return p.mode=f.uYZ,p;u=c}else{if(!(0,y.Kg)(i))return p.mode=f.uYZ,p;u=[i]}p.ids=u;const h=(0,y.xF)(s,a,d),g=u.map((t=>(0,y.ju)(t,d)));let m=null;(0,y.Gv)(h[g[0]])&&h[g[0]].values.length>0&&(m=h[g[0]].values);for(const w of g.slice(1)){let t=null;if((0,y.Gv)(h[w])&&h[w].values.length>0&&(t=h[w].values),Xe(m,t))return p.mode=f.Vt1,p}if(Array.isArray(m)&&m.length>0){[p.mode,p.values]=[f.Bcq,[]];for(const{tagName:t}of m){const{tagNameObj:e}=(0,y.LY)(t,r);(0,y.Gv)(e)&&p.values.push({tagName:t,displayName:e.displayName,color:e.color})}}p.hints=[];for(const f of r){const{tagName:t,displayName:e,color:o}=f,s=p.values.some((e=>e.tagName===t));p.hints.push({tagName:t,displayName:e,color:o,isBlur:s})}return p})(s);return t.mode===f.uYZ?(s().display.isNoteListItemMenuPopupShown&&(0,N.Bt)(f.nm0,!1,null),void(s().display.isBulkEditMenuPopupShown&&(0,N.Bt)(f.bL,!1,null))):(o({type:h.VE0,payload:t}),void(0,N.Bt)(f.SMo,!0,null,!0))}(0,N.Bt)(f.SMo,!1)},We=(t,e,o,s,n)=>{const a={};return Array.isArray(t)&&(a.values=t),Array.isArray(e)&&(a.hints=e),(0,y.Kg)(o)&&(a.displayName=o),(0,y.Kg)(s)&&(a.color=s),(0,y.Kg)(n)?a.msg=n:a.msg="",{type:h.VE0,payload:a}},Ve=(t,e,o,s)=>async(n,a)=>{o=o.trim();const r=(0,y.jm)(null,o,[]);if(r!==f.asr)return void n(We(null,null,null,null,f.Gt2[r]));if(t.some((t=>t.displayName===o)))return void n(We(null,null,null,null,f.Gt2[f.tKS]));const i=a().settings.tagNameMap,{tagNameObj:l}=(0,y.YR)(o,i);let c;(0,y.Gv)(l)&&(c=l.tagName),(0,y.Kg)(c)||(c=`${Date.now()}-${(0,y.DU)(4)}`);const d=[...t,{tagName:c,displayName:o,color:s}],p=e.map((t=>t.tagName!==c?t:{...t,isBlur:!0}));n(We(d,p,"",null,""))},Je=(t,e)=>async(o,s)=>{const{queryString:n,noteId:a,isBulkEditing:r}=s().display;if(!r&&t.includes(a)&&n){const t=n.trim();if(!e.some((e=>e.tagName===t))){const t=s().window.width;(0,y.Et)(t)&&t>=f.lXt&&o((0,N.RY)(null))}}if(r&&(0,N.RW)(!1),!Array.isArray(t)||0===t.length)return void console.log("In updateTagData, invalid ids: ",t);const i={};for(const l of t)i[l]=e;await Ye(t,i)(o,s)},Ye=(t,e)=>async(o,s)=>{const n=s().pendingSslts,a=s().settings.tagNameMap,r=s().snapshot.settings.tagNameMap,i=(0,y.tQ)(s()),l=(0,y.ln)(s()),d=(0,y.x$)(s()),{toRootIds:p}=(0,y.tk)(i,l,n),u=(0,y.xF)(d,{},p),g=[],m={};for(const c of t){const[t,o]=[e[c],(0,y.ju)(c,p)],s=[],n=[];if((0,y.Gv)(u[o]))for(const e of u[o].values)s.push(e.tagName);for(const e of t)n.push(e.tagName);(0,y.Ob)(s,n)||(g.push(c),m[c]=t)}if(0===g.length)return;const w={},v=[],I=[];for(const t of g){const e=m[t];for(const o of e){const{tagNameObj:e}=(0,y.LY)(o.tagName,a),{tagNameObj:s}=(0,y.LY)(o.tagName,r);(0,y.Gv)(e)&&(0,y.Gv)(s)||(Array.isArray(w[t])||(w[t]=[]),w[t].push(o),I.includes(o.tagName)||(v.push(o),I.push(o.tagName)))}}const A={ids:g,valuesPerId:m,newTagNameObjsPerId:w,newTagNameObjs:v};o({type:h.Bkp,payload:A});const k=((t,e,o)=>async()=>{const s=o().settings,n=o().snapshot.settings;if(!(0,y.n4)(s,n)){const r=Date.now(),{fpaths:i,ids:l}=(0,y.qO)((0,y.Gi)(o())),d=(0,y.Cd)(`${r}${(0,y.DU)(4)}`,l),p=(0,y.BK)(d);let u=s.sortOn!==n.sortOn||s.doDescendingOrder!==n.doDescendingOrder;t={...t,doUpdateSettings:!0,settings:s,doFetch:u},b.Ay.updateSettings.doFetch=u;try{await c.A.putSettings({settingsFPaths:[p],settingsContents:[s]})}catch(a){return console.log("updateTagDataSStep error: ",a),e({type:h.WR5,payload:{...t,error:a}}),void(b.Ay.updateSettings.doFetch=!1)}await xt(i)}e({type:h.X81,payload:t}),b.Ay.updateSettings.doFetch=!1})(A,o,s);k[f.h66]=h.Bkp,N.rK.push(k)},He=(t,e,o,s)=>{const n={},i=[],l=[];if((0,y.Gv)(s[e]))for(const a of s[e].values)n[a.tagName]={...a,diffs:[]},i.push(a.tagName);for(const a of o)n[a.tagName]={...n[a.tagName],diffs:[]},l.push(a.tagName);const c=(0,r.nN)(i,l);for(const a of c){const[t,e]=[a[0],a[1]];n[e].diffs.push(t)}for(const a in n){const t=n[a].diffs;1===t.length&&t.includes(r.lw)?n[a].diffType=r.lw:1===t.length&&t.includes(r.Cm)?n[a].diffType=r.Cm:1===t.length&&t.includes(r.Ug)?n[a].diffType=r.Ug:2===t.length&&t.includes(r.Ug)&&t.includes(r.Cm)?n[a].diffType="DIFF_UPDATE":console.log("Found invalid diffs for tn:",a,t)}const d=[];for(const a of l){n[a].diffType!==r.lw?d.push(null):d.push(n[a].rank)}for(let r=0;r<d.length;r++){if((0,y.Kg)(d[r]))continue;let t,e,o;for(let s=r-1;s>=0;s--)if((0,y.Kg)(d[s])){t=d[s];break}for(let s=r+1;s<d.length;s++)if((0,y.Kg)(d[s])){e=d[s];break}if((0,y.Kg)(t)&&(0,y.Kg)(e)){const s=a.X.parse(`0|${t.replace("_",":")}`),n=a.X.parse(`0|${e.replace("_",":")}`);o=t===e?s:s.between(n)}else o=(0,y.Kg)(t)?a.X.parse(`0|${t.replace("_",":")}`).genNext():(0,y.Kg)(e)?a.X.parse(`0|${e.replace("_",":")}`).genPrev():a.X.middle();d[r]=o.toString().slice(2).replace(":","_")}for(let a=0;a<l.length;a++)n[l[a]].rank=d[a];let p=Date.now();const u=[];for(const a in n){const e=n[a];if(e.diffType===r.lw)continue;let o=t;e.diffType===r.Cm&&(o=`deleted${t}`);const s=(0,y.Et)(e.addedDT)?e.addedDT:p,i=(0,y.I9)(a,e.rank,p,s,o);u.push({id:i,type:f.$tn,path:i,content:{}}),p+=1}return{pfValues:u}},Ze=(t,e)=>async(o,s)=>{const n=s().pendingSslts,a=(0,y.tQ)(s()),r=(0,y.ln)(s()),i=(0,y.x$)(s()),{toRootIds:l}=(0,y.tk)(a,r,n),d=(0,y.xF)(i,{},l),p=[],u={};for(const c of t){const[t,o]=[(0,y.ju)(c,l),e[c]],s=He(c,t,o,d);p.push(...s.pfValues),u[t]=s.pfValues}const g={ids:t,valuesPerId:e};o({type:h.uj$,payload:g});const m=[];for(let t=0;t<p.length;t+=800){const e={values:p.slice(t,t+800),isSequential:!1,nItemsForNs:f.NrX};try{const t=await c.A.performFiles(e);m.push(...t)}catch(I){return console.log("updateTagDataTStep error: ",I),void o({type:h.Z71,payload:{...g,error:I}})}}const w=(0,y.Vh)(m),b=[],N=[],v=[];for(const e of t){const t=(0,y.ju)(e,l);let o;for(const e of u[t]){const t=w[e.id];if(!(0,y.Gv)(t)||!t.success){o=new Error("Error on previous dependent item"),(0,y.Gv)(t)&&(o=new Error(t.error));break}}o?(N.push(e),v.push(o)):b.push(e)}o({type:h.Gnx,payload:{...g,successIds:b,errorIds:N,errors:v}})},to=()=>async(t,e)=>{const o=e().pendingTags,s=[],n={},a=[],r={};for(const i in o){const{status:t,values:e}=o[i];t===h.WR5?(s.push(i),n[i]=e):t===h.Z71&&(a.push(i),r[i]=e)}s.length>0&&await Ye(s,n)(t,e),a.length>0&&await Ze(a,r)(t,e)},eo=()=>async(t,e)=>{const o=e().settings,s=e().snapshot.settings,n=e().pendingSslts,a=e().pendingTags,r=(0,y.tQ)(e()),i=(0,y.ln)(e()),l=(0,y.x$)(e()),c=(0,y.n4)(o.tagNameMap,s.tagNameMap),d=[],p=[],u=[],f=[];for(const y in a){const{status:t,newTagNameObjs:e}=a[y];if([h.WR5,h.Z71].includes(t)&&d.push(y),t!==h.WR5)for(const o of e)u.includes(o.tagName)||u.push(o.tagName);else for(const o of e)p.includes(o.tagName)||p.push(o.tagName)}if(!c&&p.length>0){for(const n of s.tagNameMap)u.includes(n.tagName)||u.push(n.tagName);const{noteMetas:t,conflictedMetas:e,toRootIds:o}=(0,y.tk)(r,i,n),a=(0,y.Vr)(t,e,o,l,{});for(const s of a)u.includes(s)||u.push(s);for(const s of p)u.includes(s)||f.push(s)}t({type:h.q19,payload:{ids:d,unusedTagNames:f}})},oo=()=>async(t,e)=>{const o=e().pendingSslts,s=(0,y.tQ)(e()),n=(0,y.ln)(e()),a=(0,y.x$)(e()),{noteMetas:r,conflictedMetas:i,toRootIds:l}=(0,y.tk)(s,n,o),d=(0,y.O4)(r,i,l),p=(0,y._3)(a,l);let u=f.NrX;e().user.hubUrl===f.MbX&&(u=60);const h=[];for(const c of a){if(h.length>=u)break;const{id:t}=(0,y.tF)(c),e=t.startsWith("deleted")?t.slice(7):t,o=(0,y.ju)(e,l);if(!(0,y.Kg)(o)||!d.includes(o)||!(0,y.Gv)(p[o])){h.push({id:c,type:f.BCn,path:c,doIgnoreDoesNotExistError:!0});continue}p[o].values.some((t=>t.fpath===c))||h.push({id:c,type:f.BCn,path:c,doIgnoreDoesNotExistError:!0})}if(h.length>0)try{const t={values:h,isSequential:!1,nItemsForNs:f.NrX};await c.A.performFiles(t)}catch(g){console.log("cleanUpTags error: ",g)}t(Rt())},so=t=>({type:h._7s,payload:t}),no=(t,e)=>{let o=Date.now();const s=[];for(let n=0;n<t.length;n++){const[a,r]=[t[n],e[n]],i={tagName:`${o}-${(0,y.DU)(4)}`,displayName:a,color:r};s.push(i),o+=1}return{type:h.MJ$,payload:s}},ao=(t,e)=>({type:h.E$q,payload:{tagNames:t,newNames:e}}),ro=(t,e)=>({type:h.dTL,payload:{tagName:t,direction:e}}),io=(t,e)=>{},lo=(t,e)=>async(o,s)=>{const n=s().pendingSslts,a=s().pendingTags,r=(0,y.tQ)(s()),i=(0,y.ln)(s()),l=(0,y.x$)(s()),{noteMetas:c,conflictedMetas:d,toRootIds:p}=(0,y.tk)(r,i,n);(0,y.Vr)(c,d,p,l,a).includes(e.tagName)?o(so({[t]:{msg:f.Gt2[f.TB2],isCheckingCanDelete:!1}})):(o(po(e.tagName)),o(Vt(f.E3J)),(0,N.Bt)(f.atb,!0),o(so({[t]:{msg:"",isCheckingCanDelete:!1}})))},co=t=>({type:h.IQu,payload:{tagNames:t}}),po=t=>({type:h.GBy,payload:t})},5566:(t,e,o)=>{"use strict";o.d(e,{n5:()=>D,GO:()=>A,i4:()=>k,Og:()=>F,By:()=>S,vi:()=>M,Xq:()=>x,cO:()=>E,dB:()=>T,Rh:()=>$,OJ:()=>L});var s=o(1407);const n={post:(t,e)=>s.A.post(t,e)};var a=o(3151),r=o(629),i=o(8159),l=o(1424);const c=!window.location.href.startsWith(i.ffP),d=t=>{if(t!==i.wlf)throw new Error(`In paddleWrapper.getProduct, invalid productId: ${t}`);return c?46921:811083};let p=null;const u=t=>{try{if("Checkout.Complete"===t.event){const e=(t=>{if(![46921,811083].includes(t))throw new Error(`In paddleWrapper.getProductId, invalid product: ${t}`);return i.wlf})(t.eventData.product.id),o=t.eventData.checkout.id,s=t.eventData.user.id,n=t.eventData.checkout.passthrough;return void h({productId:e,purchaseToken:o,paddleUserId:s,passthrough:n})}if("Checkout.Close"===t.event&&!t.eventData.checkout.completed)return void f({code:"E_USER_CANCELLED"})}catch(e){return void f(e)}};let h=null;let f;const y={initConnection:async()=>{if(p=window.Paddle,!(0,l.Gv)(p))throw new Error("Invalid window.Paddle");return c&&p.Environment.set("sandbox"),p.Setup({vendor:c?11185:163987,eventCallback:u}),!0},purchaseUpdatedListener:t=>(h=t,{remove:()=>{h=null}}),purchaseErrorListener:t=>(f=t,{remove:()=>{f=null}}),getSubscriptions:async t=>await Promise.all(t.map((t=>(t=>new Promise(((e,o)=>{p.Product.Prices(d(t),(s=>{(0,l.Gv)(s)?e({productId:t,localizedPrice:s.recurring.price.gross}):o(new Error(`Invalid prices: ${s}`))}))})))(t)))),requestSubscription:async t=>{let e=a.A.getItemSync(i.NjW);if(!(0,l.Kg)(e)){const t=(await r.A.signECDSA(i.ejf)).publicKey;e=`${(0,l.DU)(8)}-${(0,l.DU)(8)}-${(0,l.DU)(8)}-${(0,l.DU)(8)}`,await n.post(i.Ojf,{userId:t,randomId:e}),a.A.setItemSync(i.NjW,e)}const o={randomId:e};p.Checkout.open({product:d(t),passthrough:JSON.stringify(o)})}};var g=o(8103),m=o(8678);const w=async t=>{if(!t)return{status:i.uYZ};const e=i.L3j,o=(await r.A.signECDSA(i.ejf)).publicKey,s=t.productId,a=t.purchaseToken,l=t.paddleUserId,c=t.passthrough;if(!a)return console.log("No purchaseToken in rawPurchase"),{status:i.uYZ};const d={source:e,userId:o,productId:s,token:a,paddleUserId:l,passthrough:c};let p;try{p=(await n.post(i.lGw,d)).data}catch(u){return console.log(`Error when contact IAP server to verify with reqBody: ${JSON.stringify(d)}, Error: `,u),{status:i.HVg}}return p},b=async t=>{let e;for(let o=1;o<=3;o++){if(e=await w(t),e.status===i.dOD)return e;o<3&&await(0,l.yy)((0,l.XM)([3e3,4500,6e3]))}return e},N=async t=>{const e=await r.A.signECDSA(i.ejf),o=await a.A.getItem(i.NjW),s={source:i.L3j,userId:e.publicKey,signature:e.signature,appId:i.zax,doForce:t,randomId:o};return await n.post(i.ilu,s)},v=(t,e,o,s,n)=>async(a,r)=>{const{purchaseState:c,restoreStatus:d,refreshStatus:p}=r().iap;if(c===g.uUO||d===g.k8F||p===g.far)return;let u;a({type:t});try{if(u=(await N(s)).data,n)return void a({type:e,payload:u});if(u.status===i.dOD){const t=(0,l.b6)(u.purchases);if(t&&t.status===i.HcD)return void a({type:e,payload:u})}}catch(h){return console.log("Error when contact IAP server to get purchases: ",h),void a({type:o})}a({type:e,payload:u})},I=(t,e,o)=>{t?(m.Ay.iap.updatedEventEmitter||(m.Ay.iap.updatedEventEmitter=y.purchaseUpdatedListener(((t,e)=>async e=>{const o=await b(e);t({type:g.QpL,payload:{...o,rawPurchase:e}})})(e))),m.Ay.iap.errorEventEmitter||(m.Ay.iap.errorEventEmitter=y.purchaseErrorListener(((t,e)=>async o=>{console.log("Error in iapErrorListener: ",o),"E_USER_CANCELLED"===o.code?(P(t,e),t(T(null,null))):t({type:g.bPb})})(e,o)))):(m.Ay.iap.updatedEventEmitter&&(m.Ay.iap.updatedEventEmitter.remove(),m.Ay.iap.updatedEventEmitter=null),m.Ay.iap.errorEventEmitter&&(m.Ay.iap.errorEventEmitter.remove(),m.Ay.iap.errorEventEmitter=null))},A=function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return async(e,o)=>{I(!1,e,o),t||(m.Ay.iap.didGetProducts=!1,e(C(null,null,null)))}},k=t=>async(e,o)=>{if(!m.Ay.iap.didGetProducts||t){m.Ay.iap.didGetProducts=!0,e({type:g.oHj}),t&&await A(!0)(e,o);try{const t=await y.initConnection();I(!0,e,o);let s=null;t&&(s=await y.getSubscriptions([i.wlf])),e({type:g.oZC,payload:{canMakePayments:t,products:s}})}catch(s){console.log("Error when init iap and get products: ",s),e({type:g.dmI})}}},S=t=>async(e,o)=>{e({type:g.uUO});try{await y.requestSubscription(t.productId)}catch(s){console.log("Error when request purchase: ",s),"E_USER_CANCELLED"===s.code?e(T(null,null)):e({type:g.bPb})}},P=async(t,e)=>{const{purchases:o}=e().info;if(!(0,l.Gk)(o))try{const e=(await N(!1)).data;if(e.status===i.dOD){const o=(0,l.Gk)(e.purchases);if(o)return void t({type:g.QpL,payload:{status:e.status,purchase:o,rawPurchase:null}})}}catch(s){console.log("checkRequestPurchase error:",s)}},M=()=>async(t,e)=>{await v(g.k8F,g.aXk,g.Fns,!1,!1)(t,e)},F=()=>async(t,e)=>{await v(g.far,g.hu0,g.EXu,!0,!1)(t,e)},D=()=>async(t,e)=>{const{purchases:o,checkPurchasesDT:s}=e().info,n=(0,l.Gk)(o);if(!n)return;const a=Date.now();let r=!1;if(a>=new Date(n.expiryDate).getTime()||!s)r=!0;else{let t=1/(24*i.P$0*60*60*1e3)*Math.abs(a-s);t=Math.max(.01,Math.min(t,.99)),r=t>Math.random()}r&&await v(g.far,g.hu0,g.EXu,!1,!0)(t,e)},x=()=>async(t,e)=>{const o=e().iap.rawPurchase;t({type:g.uUO});const s=await b(o);t({type:g.QpL,payload:{...s,rawPurchase:o}})},E=()=>async(t,e)=>{const o=await r.A.signECDSA(i.ejf);t({type:g.Bff,payload:o.publicKey})},C=(t,e,o)=>({type:g.Cmg,payload:{status:t,canMakePayments:e,products:o}}),T=(t,e)=>({type:g._eA,payload:{status:t,rawPurchase:e}}),L=t=>({type:g.rUg,payload:t}),$=t=>({type:g.Ipj,payload:t})},3372:(t,e,o)=>{"use strict";o.d(e,{A:()=>g});var s=o(559),n=o(1963),a=o(8583),r=o(8159),i=o(1424),l=o(8678);const c=()=>l.t4.doSyncMode?n.A:s.A,d=async t=>{const e={noteFPaths:[],ssltFPaths:[],staticFPaths:[],settingsFPaths:[],infoFPath:null,pinFPaths:[],tagFPaths:[]};return await t((t=>((0,i.J_)(e,t),!0))),e},p=(t,e,o)=>{const s={};for(let r=0;r<e.length;r++){const[t,n]=[e[r],o[r]];s[t]=n}const n=[],a=[];for(const l of t){let t="",e="",o=[];for(const n of l.fpaths){const a=s[n],{subName:l}=(0,i.X0)(n);l===r.hxw+r.rWq?(0,i.Gv)(a)&&([t,e]=[a.title,a.body]):o.push({name:l,content:a})}n.push(l.listName),a.push({parentIds:l.parentIds,id:l.id,title:t,body:e,media:o,addedDT:l.addedDT,updatedDT:l.updatedDT})}return{listNames:n,notes:a}},u=async(t,e)=>{if(l.t4.doSyncMode)return;const o=[];for(const s of t)for(const t of s.notes)if(Array.isArray(t.media))for(const{name:e}of t.media)if(e.startsWith(r.d91+"/")){const t=(0,i._$)(e);o.includes(t)||o.push(t)}for(const s of e)if(Array.isArray(s.media))for(const{name:t}of s.media)if(t.startsWith(r.d91+"/")){const e=(0,i._$)(t);o.includes(e)||o.push(e)}const n=[];for(const s of o){void 0===await a.A.getFile(s)&&n.push(s)}for(let i=0;i<n.length;i+=r.NrX){const t=n.slice(i,i+r.NrX),e=await s.A.getFiles(t,!0);for(const{fpath:o,content:s}of e.responses)null!==s&&await a.A.putFile(o,s)}},h=async(t,e)=>{const o={values:t,isSequential:!1,nItemsForNs:r.NrX},s=await y(o),n=(0,i.Vh)(s),a=[],l=[],c=[];for(const r in e){const[t,o]=[e[r],n[r]];if((0,i.Gv)(o)&&o.success)a.push(t);else{let e=new Error("Error on previous dependent item");(0,i.Gv)(o)&&(e=new Error(o.error)),l.push(t),c.push(e)}}return{successPins:a,errorPins:l,errors:c}},f=async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o={responses:[],fpaths:[],contents:[]},s=[];if(l.t4.doSyncMode)s.push(...t);else for(const a of t){let t;[r.Y6J,r.cPx,r.yyQ,r.rDG,r.$xt,r.gpL].some((t=>a.startsWith(t)))&&(t=await n.A.getFile(a,!0)),void 0!==t?(o.responses.push({content:t,fpath:a,success:!0}),o.fpaths.push(a),o.contents.push(t)):s.push(a)}for(let a=0;a<s.length;a+=r.NrX){const t=s.slice(a,a+r.NrX),d=await(0,i.lL)(c().getFile,t,0,e);for(const e of d)if(o.responses.push(e),o.fpaths.push(e.fpath),o.contents.push(e.content),!l.t4.doSyncMode&&e.success){const{fpath:t,content:o}=e;[r.Y6J,r.cPx,r.yyQ,r.rDG,r.$xt,r.gpL].some((e=>t.startsWith(e)))&&await n.A.putFile(t,o)}}return o},y=async t=>{let e;if(l.t4.doSyncMode)e=await n.A.performFiles(t);else{e=await s.A.performFiles(t);const o=(0,i.nw)(t);for(const s of e){if(!s.success)continue;const{type:e,path:a,content:i}=o[s.id];[r.Y6J,r.cPx,r.yyQ,r.rDG,r.$xt,r.gpL].some((t=>a.startsWith(t)))&&(e===r.$tn?await n.A.putFile(a,i):e===r.BCn?await n.A.deleteFile(a):console.log("In blockstack.performFiles, invalid data:",t))}}return e},g={listFPaths:async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,i.Gv)(c().cachedFPaths.fpaths)&&!t||(c().cachedFPaths.fpaths=await d(c().listFiles)),c().cachedFPaths.fpaths},listServerFPaths:async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,i.Gv)(s.A.cachedFPaths.fpaths)&&!t||(s.A.cachedFPaths.fpaths=await d(s.A.listFiles)),s.A.cachedFPaths.fpaths},toNotes:p,fetchStgsAndInfo:async(t,e)=>{if(l.t4.doSyncMode){if(!await n.A.canUseSync())throw new Error("Sync mode cannnot be used.")}let o,s,a=[];const{fpaths:r,ids:c}=(0,i.qO)(t);if(r.length>0){const t=await f(r,!0),{fpaths:e,contents:s}=(0,i.jf)(t.fpaths,t.contents);for(let n=0;n<e.length;n++){const[t,i]=[e[n],s[n]];1!==e.length?a.push({...i,id:c[r.indexOf(t)],fpath:t}):o=i}}if(e){const{contents:t}=await f([e],!0);(0,i.Gv)(t[0])&&(s=t[0])}(0,i.Gv)(o)&&!(0,i.Gv)(s)&&"purchases"in o&&(s={purchases:o.purchases,checkPurchasesDT:null},"checkPurchasesDT"in o&&(s.checkPurchasesDT=o.checkPurchasesDT)),(0,i.Gv)(o)&&("purchases"in o&&(o.purchases=null),"checkPurchasesDT"in o&&(o.checkPurchasesDT=null));for(const n of a)"purchases"in n&&(n.purchases=null),"checkPurchasesDT"in n&&(n.checkPurchasesDT=null);return{settings:o,conflictedSettings:a,info:s}},fetchNotes:async t=>{const e=[],o=[],s=[];for(const r of t)if(r.isConflicted){for(const t of r.metas)e.push(...t.fpaths);s.push(r)}else e.push(...r.fpaths),o.push(r);const n=[],a=[],l=[];for(const i of e)i.includes(r.d91+"/")?(a.push(i),l.push("")):n.push(i);const{responses:c}=await f(n,!0);for(const{fpath:r,content:i}of c)a.push(r),l.push(i);const d=((t,e,o)=>{const s=[];for(const n of t){const{notes:t}=p(n.metas,e,o);s.push({id:n.id,listNames:n.listNames,notes:t,addedDT:n.addedDT,updatedDT:n.updatedDT,isConflicted:n.isConflicted})}return s})(s,a,l),{listNames:h,notes:y}=p(o,a,l);await u(d,y);const g={};for(const r of d)g[r.id]=r;const m={};for(let r=0;r<h.length;r++){const[t,e]=[h[r],y[r]];(0,i.Gv)(m[t])||(m[t]={}),m[t][e.id]=e}return{conflictedNotes:g,notes:m}},putNotes:async t=>{const{listNames:e,notes:o,staticFPaths:s,manuallyManageError:n}=t,c=[],d=[],p=[],u=[],h=[],f=await(async(t,e,o,s)=>{let n=[],c=[],d=[];if(!l.t4.doSyncMode&&Array.isArray(o))for(const l of o){const t=await a.A.getFile(l);n.push({id:l,type:r.$tn,path:l,content:t}),[n,c]=await(0,i._y)(y,n,c,[],[])}for(let a=0;a<t.length;a++){const[o,s]=[t[a],e[a]],l=(0,i.Cd)(s.id,s.parentIds);if(Array.isArray(s.media)){for(const{name:t,content:e}of s.media){const s=(0,i.o0)(o,l,t);c.push({id:s,type:r.$tn,path:s,content:e})}[n,c]=await(0,i._y)(y,n,c,[],[])}const p=(0,i.o0)(o,l,r.hxw+r.rWq),u={title:s.title,body:s.body};d.push({id:s.id,type:r.$tn,path:p,content:u})}const p=i.sF.cSize,u=i.sF.sSize*n.length+i.sF.eSize*c.length;let h=[...n,...c],f=[],g=u;const m=[];for(const a of d){const t=(0,i.Hz)(a,p);if(g+t>i.sF.maxSize){if(h.length>0){const t={values:h,isSequential:!1,nItemsForNs:r.NrX},e=await y(t);(0,i.Uq)(t,e),m.push(...e),[h,g]=[[],g-u]}if(g+t>i.sF.maxSize){const t={values:f,isSequential:!1,nItemsForNs:r.NrX},e=await y(t);if(!0!==s&&(0,i.Uq)(t,e),m.push(...e),e.some((t=>!t.success)))return m;[f,g]=[[],0]}}f.push(a),g+=t}let w;w=h.length>0?{values:[{values:h,isSequential:!1,nItemsForNs:r.NrX},{values:f,isSequential:!1,nItemsForNs:r.NrX}],isSequential:!0,nItemsForNs:r.NrX}:{values:f,isSequential:!1,nItemsForNs:r.NrX};const b=await y(w);return!0!==s&&(0,i.Uq)(w,b),m.push(...b),m})(e,o,s,n),g=(0,i.Vh)(f);for(let a=0;a<e.length;a++){const[t,s]=[e[a],o[a]],n=g[s.id];if((0,i.Gv)(n)&&n.success)c.push(t),d.push(s);else{let e=new Error("Error on previous dependent item");(0,i.Gv)(n)&&(e=new Error(n.error)),p.push(t),u.push(s),h.push(e)}}return{successListNames:c,successNotes:d,errorListNames:p,errorNotes:u,errors:h}},moveNotes:async t=>{const{listNames:e,notes:o}=t;let s=Date.now();const n=[];for(let y=0;y<e.length;y++){const[t,a]=[e[y],o[y]],l=(0,i.CI)(t,s,s,a.id);n.push({id:a.id,type:r.$tn,path:l,content:{}}),s+=1}const a=[],l=[],c=[],d=[],p=[],u={values:n,isSequential:!1,nItemsForNs:r.NrX},h=await y(u),f=(0,i.Vh)(h);for(let r=0;r<e.length;r++){const[t,s]=[e[r],o[r]],n=f[s.id];if((0,i.Gv)(n)&&n.success)a.push(t),l.push(s);else{let e=new Error("Error on previous dependent item");(0,i.Gv)(n)&&(e=new Error(n.error)),c.push(t),d.push(s),p.push(e)}}return{successListNames:a,successNotes:l,errorListNames:c,errorNotes:d,errors:p}},putSettings:async t=>{const{settingsFPaths:e,settingsContents:o}=t,s=[];for(let i=0;i<e.length;i++){const[t,n]=[e[i],o[i]];s.push({id:t,type:r.$tn,path:t,content:n})}const n={values:s,isSequential:!1,nItemsForNs:r.NrX},a=await y(n);(0,i.Uq)(n,a)},putInfos:async t=>{const{infoFPaths:e,infos:o}=t,s=[];for(let i=0;i<e.length;i++){const[t,n]=[e[i],o[i]];s.push({id:t,type:r.$tn,path:t,content:n})}const n={values:s,isSequential:!1,nItemsForNs:r.NrX},a=await y(n);(0,i.Uq)(n,a)},deleteInfos:async t=>{const{infoFPaths:e}=t,o=[];for(const a of e)o.push({id:a,type:r.BCn,path:a,doIgnoreDoesNotExistError:!0});const s={values:o,isSequential:!1,nItemsForNs:r.NrX},n=await y(s);(0,i.Uq)(s,n)},putPins:async t=>{const{pins:e}=t,o=[],s={};for(const n of e){const t=(0,i.$h)(n.rank,n.updatedDT,n.addedDT,n.id);o.push({id:t,type:r.$tn,path:t,content:{}}),s[t]=n}return await h(o,s)},deletePins:async t=>{const{pins:e}=t,o=[],s={};for(const n of e){const t=(0,i.$h)(n.rank,n.updatedDT,n.addedDT,`deleted${n.id}`);o.push({id:t,type:r.$tn,path:t,content:{}}),s[t]=n}return await h(o,s)},getFiles:f,performFiles:y}},629:(t,e,o)=>{"use strict";o.d(e,{A:()=>r});var s=o(8090),n=o(4635),a=o(8565);const r={signECDSA:async t=>{const e=a.A.loadUserData();return(0,s.iM)(e.appPrivateKey,t)},encrypt:t=>{const e={privateKey:a.A.loadUserData().appPrivateKey};return(0,n.h)(t,e)},decrypt:t=>{const e={privateKey:a.A.loadUserData().appPrivateKey};return(0,n.P)(t,e)}}},559:(t,e,o)=>{"use strict";o.d(e,{A:()=>F});var s=o(8790),n=o(1860),a=o(8090),r=o(7138),i=o(6177),l=o(8565),c=o(8159),d=o(1424);const p=l.A._userSession,u=(0,i.Hq)(),h=async(t,e)=>{const o={...t};if(Array.isArray(t.values)&&[!0,!1].includes(t.isSequential)){o.values=[];for(const s of t.values){const t=await h(s,e);o.values.push(t)}}else if((0,d.Kg)(t.id)&&(0,d.Kg)(t.type)&&(0,d.Kg)(t.path)){if(t.type===c.$tn){const s=new n.Z(t.content,null),r=await s.load(),i=s.wasString,l="hex";o.content=await(0,a.Nq)(e,r,i,l)}}else console.log("In encryptData, invalid data:",t);return o},f={performFiles:async t=>{const e=l.A.loadUserData();let{appPrivateKey:o,gaiaHubConfig:n}=e;if(!(0,d.Gv)(n)){const t=new s.w({userSession:p});n=await t.getOrSetLocalGaiaHubConnection()}const a=(0,r.sP)(o),i=await h(t,a),c=`${n.server}/perform-files/${n.address}`,f=await u(c,{method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json",Authorization:`bearer ${n.token}`},body:JSON.stringify(i)});if(f.ok){return await f.json()}throw new Error(`(performFiles) Error ${f.status}`)}},y=t=>{let e=[];const o=(t,o)=>{for(const s of e)if(s.rId===t)return void([s.dt,s.nRequests]=[Date.now(),o]);e.push({rId:t,dt:Date.now(),nRequests:o})};return{respectLimit:async(s,n)=>{const a=t,r=6e4;let i=!1;for(let t=1;t<=4;t++){e=e.filter((t=>t.dt>=Date.now()-r));let l=0,c=Date.now(),p=!1;for(let t=e.length-1;t>=0;t--){const o=e[t];if(o.nRequests+l>=a){p=!0;break}l+=o.nRequests,c=o.dt}if(!p){o(s,n),i=!0;break}if(t<4){const t=(0,d.XM)([1e3,1500,2e3,2500,3e3,3500,4e3,4500,5e3]);let e=r-(Date.now()-c)+t;e<0&&(e=0),e>r+t&&(e=r+t),await(0,d.yy)(e)}}return i},updateNetworkInfos:o}};var g=o(8678);const m=l.A._userSession;let w,b;const N=async function(t,e){let o,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s?(b||(b=y(288)),o=b):(w||(w=y(g.Ay.user.hubUrl===c.MbX?144:72)),o=w),await o.respectLimit(t,e)},v=function(t,e){let o,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];s?(b||(b=y(288)),o=b):(w||(w=y(g.Ay.user.hubUrl===c.MbX?144:72)),o=w),o.updateNetworkInfos(t,e)},I=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=`${Date.now()}${(0,d.DU)(4)}`;g.Ay.user.hubUrl===c.MbX?await N(o,1,!0):await N(o,1);const n=new s.w({userSession:m});let a=await n.getFile(t,e);return t.endsWith(c.rWq)&&(a=JSON.parse(a)),g.Ay.user.hubUrl===c.MbX?v(o,1,!0):v(o,1),a},A={dangerouslyIgnoreEtag:!0},k=async t=>{const e={...t};if(Array.isArray(t.values)&&[!0,!1].includes(t.isSequential)){e.values=[];for(const o of t.values){const t=await k(o);e.values.push(t)}}else(0,d.Kg)(t.id)&&(0,d.Kg)(t.type)&&(0,d.Kg)(t.path)?t.type===c.$tn&&t.path.endsWith(c.rWq)&&(e.content=JSON.stringify(t.content)):console.log("In stringifyData, invalid data:",t);return e},S=async t=>{if(Array.isArray(t.values)&&0===t.values.length)return[];const e=`${Date.now()}${(0,d.DU)(4)}`;await N(e,2);const o=await k(t),s=await f.performFiles(o);return await(async(t,e)=>{if(!(0,d.Gv)(g.QC.fpaths))return;const o=(0,d.sI)(g.QC.fpaths),s=(0,d.nw)(t);for(const n of e){if(!n.success)continue;const{type:e,path:a}=s[n.id];e===c.$tn?(0,d.J_)(o,a):e===c.BCn?(0,d.Z5)(o,a):console.log("In cacheData, invalid data:",t)}g.QC.fpaths=o})(t,s),v(e,2),s},P=async t=>{const{id:e,type:o,path:n}=t;if(o===c.$tn){const o=await async function(t,e){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:A;const n=`${Date.now()}${(0,d.DU)(4)}`;await N(n,2),t.endsWith(c.rWq)&&(e=JSON.stringify(e));const a=new s.w({userSession:m}),r=await a.putFile(t,e,o);if((0,d.Gv)(g.QC.fpaths)){const e=(0,d.sI)(g.QC.fpaths);(0,d.J_)(e,t),g.QC.fpaths=e}return v(n,2),r}(n,t.content);return{success:!0,id:e,publicUrl:o}}if(o===c.BCn){try{await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o=`${Date.now()}${(0,d.DU)(4)}`;await N(o,2);const n=new s.w({userSession:m}),a=await n.deleteFile(t,e);if((0,d.Gv)(g.QC.fpaths)){const e=(0,d.sI)(g.QC.fpaths);(0,d.Z5)(e,t),g.QC.fpaths=e}return v(o,2),a}(n)}catch(a){if(!((0,d.Gv)(a)&&(0,d.Kg)(a.message)&&(a.message.includes("failed to delete")&&a.message.includes("404")||a.message.includes("deleteFile Error")&&a.message.includes("GaiaError error 5")||a.message.includes("does_not_exist")||a.message.includes("file_not_found"))))throw a}return{success:!0,id:e}}throw new Error(`Invalid data.type: ${t.type}`)},M=async t=>{const e=[];if(Array.isArray(t.values)&&[!0,!1].includes(t.isSequential))if(t.isSequential)for(const s of t.values){const t=await M(s);if(e.push(...t),t.some((t=>!t.success)))break}else{let o=1;(0,d.Et)(t.nItemsForNs)&&(o=Math.min(t.nItemsForNs,c.NrX));for(let s=0;s<t.values.length;s+=o){const n=t.values.slice(s,s+o),a=await Promise.all(n.map((t=>M(t))));for(const t of a)e.push(...t)}}else if((0,d.Kg)(t.id)&&(0,d.Kg)(t.type)&&(0,d.Kg)(t.path))try{const o=await P(t);e.push(o)}catch(o){e.push({error:o.toString().slice(0,999),success:!1,id:t.id})}else console.log("In nsPerformFiles, invalid data:",t);return e},F={cachedFPaths:g.QC,getFile:I,getFiles:async function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const o={responses:[],fpaths:[],contents:[]};for(let s=0;s<t.length;s+=c.NrX){const n=t.slice(s,s+c.NrX),a=await(0,d.lL)(I,n,0,e);for(const t of a)o.responses.push(t),o.fpaths.push(t.fpath),o.contents.push(t.content)}return o},performFiles:async t=>{let e;return e=g.Ay.user.hubUrl===c.MbX?await S(t):await M(t),e},listFiles:async t=>{const e=`${Date.now()}${(0,d.DU)(4)}`;await N(e,2);const o=new s.w({userSession:m}),n=await o.listFiles((e=>"auth/authTimestamp"===e||t(e))),a=g.Ay.user.hubUrl===c.MbX?2400:100;return v(e,Math.ceil(n/a)+1),n}}},3848:t=>{t.exports='<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no" /> <title>__-title-__</title> <style>/* ! tailwindcss v3.2.4 | MIT License | https://tailwindcss.com */  /* 1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4) 2. Allow adding a border to an element by just adding a border-width. (https://github.com/tailwindcss/tailwindcss/pull/116) */  *, ::before, ::after { box-sizing: border-box; /* 1 */ border-width: 0; /* 2 */ border-style: solid; /* 2 */ border-color: #e5e7eb; /* 2 */ }  ::before, ::after { --tw-content: \'\'; }  /* 1. Use a consistent sensible line-height in all browsers. 2. Prevent adjustments of font size after orientation changes in iOS. 3. Use a more readable tab size. 4. Use the user\'s configured `sans` font-family by default. 5. Use the user\'s configured `sans` font-feature-settings by default. */  html { line-height: 1.5; /* 1 */ -webkit-text-size-adjust: 100%; /* 2 */ -moz-tab-size: 4; /* 3 */ -o-tab-size: 4; tab-size: 4; /* 3 */ font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; /* 4 */ font-feature-settings: normal; /* 5 */ }  /* 1. Remove the margin in all browsers. 2. Inherit line-height from `html` so users can set them as a class directly on the `html` element. */  body { margin: 0; /* 1 */ line-height: inherit; /* 2 */ }  /* 1. Add the correct height in Firefox. 2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655) 3. Ensure horizontal rules are visible by default. */  hr { height: 0; /* 1 */ color: inherit; /* 2 */ border-top-width: 1px; /* 3 */ }  /* Add the correct text decoration in Chrome, Edge, and Safari. */  abbr:where([title]) { -webkit-text-decoration: underline dotted; text-decoration: underline dotted; }  /* Remove the default font size and weight for headings. */  h1, h2, h3, h4, h5, h6 { font-size: inherit; font-weight: inherit; }  /* Reset links to optimize for opt-in styling instead of opt-out. */  a { color: inherit; text-decoration: inherit; }  /* Add the correct font weight in Edge and Safari. */  b, strong { font-weight: bolder; }  /* 1. Use the user\'s configured `mono` font family by default. 2. Correct the odd `em` font sizing in all browsers. */  code, kbd, samp, pre { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; /* 1 */ font-size: 1em; /* 2 */ }  /* Add the correct font size in all browsers. */  small { font-size: 80%; }  /* Prevent `sub` and `sup` elements from affecting the line height in all browsers. */  sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }  sub { bottom: -0.25em; }  sup { top: -0.5em; }  /* 1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297) 2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016) 3. Remove gaps between table borders by default. */  table { text-indent: 0; /* 1 */ border-color: inherit; /* 2 */ border-collapse: collapse; /* 3 */ }  /* 1. Change the font styles in all browsers. 2. Remove the margin in Firefox and Safari. 3. Remove default padding in all browsers. */  button, input, optgroup, select, textarea { font-family: inherit; /* 1 */ font-size: 100%; /* 1 */ font-weight: inherit; /* 1 */ line-height: inherit; /* 1 */ color: inherit; /* 1 */ margin: 0; /* 2 */ padding: 0; /* 3 */ }  /* Remove the inheritance of text transform in Edge and Firefox. */  button, select { text-transform: none; }  /* 1. Correct the inability to style clickable types in iOS and Safari. 2. Remove default button styles. */  button, [type=\'button\'], [type=\'reset\'], [type=\'submit\'] { -webkit-appearance: button; /* 1 */ background-color: transparent; /* 2 */ background-image: none; /* 2 */ }  /* Use the modern Firefox focus style for all focusable elements. */  :-moz-focusring { outline: auto; }  /* Remove the additional `:invalid` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737) */  :-moz-ui-invalid { box-shadow: none; }  /* Add the correct vertical alignment in Chrome and Firefox. */  progress { vertical-align: baseline; }  /* Correct the cursor style of increment and decrement buttons in Safari. */  ::-webkit-inner-spin-button, ::-webkit-outer-spin-button { height: auto; }  /* 1. Correct the odd appearance in Chrome and Safari. 2. Correct the outline style in Safari. */  [type=\'search\'] { -webkit-appearance: textfield; /* 1 */ outline-offset: -2px; /* 2 */ }  /* Remove the inner padding in Chrome and Safari on macOS. */  ::-webkit-search-decoration { -webkit-appearance: none; }  /* 1. Correct the inability to style clickable types in iOS and Safari. 2. Change font properties to `inherit` in Safari. */  ::-webkit-file-upload-button { -webkit-appearance: button; /* 1 */ font: inherit; /* 2 */ }  /* Add the correct display in Chrome and Safari. */  summary { display: list-item; }  /* Removes the default spacing and border for appropriate elements. */  blockquote, dl, dd, h1, h2, h3, h4, h5, h6, hr, figure, p, pre { margin: 0; }  fieldset { margin: 0; padding: 0; }  legend { padding: 0; }  ol, ul, menu { list-style: none; margin: 0; padding: 0; }  /* Prevent resizing textareas horizontally by default. */  textarea { resize: vertical; }  /* 1. Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300) 2. Set the default placeholder color to the user\'s configured gray 400 color. */  input::-moz-placeholder, textarea::-moz-placeholder { opacity: 1; /* 1 */ color: #9ca3af; /* 2 */ }  input::placeholder, textarea::placeholder { opacity: 1; /* 1 */ color: #9ca3af; /* 2 */ }  /* Set the default cursor for buttons. */  button, [role="button"] { cursor: pointer; }  /* Make sure disabled buttons don\'t get the pointer cursor. */  :disabled { cursor: default; }  /* 1. Make replaced elements `display: block` by default. (https://github.com/mozdevs/cssremedy/issues/14) 2. Add `vertical-align: middle` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210) This can trigger a poorly considered lint error in some tools but is included by design. */  img, svg, video, canvas, audio, iframe, embed, object { display: block; /* 1 */ vertical-align: middle; /* 2 */ }  /* Constrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14) */  img, video { max-width: 100%; height: auto; }  /* Make elements with the HTML hidden attribute stay hidden by default */  [hidden] { display: none; }  [type=\'text\'],[type=\'email\'],[type=\'url\'],[type=\'password\'],[type=\'number\'],[type=\'date\'],[type=\'datetime-local\'],[type=\'month\'],[type=\'search\'],[type=\'tel\'],[type=\'time\'],[type=\'week\'],[multiple],textarea,select { -webkit-appearance: none; -moz-appearance: none; appearance: none; background-color: #fff; border-color: #6b7280; border-width: 1px; border-radius: 0px; padding-top: 0.5rem; padding-right: 0.75rem; padding-bottom: 0.5rem; padding-left: 0.75rem; font-size: 1rem; line-height: 1.5rem; --tw-shadow: 0 0 #0000; }  [type=\'text\']:focus, [type=\'email\']:focus, [type=\'url\']:focus, [type=\'password\']:focus, [type=\'number\']:focus, [type=\'date\']:focus, [type=\'datetime-local\']:focus, [type=\'month\']:focus, [type=\'search\']:focus, [type=\'tel\']:focus, [type=\'time\']:focus, [type=\'week\']:focus, [multiple]:focus, textarea:focus, select:focus { outline: 2px solid transparent; outline-offset: 2px; --tw-ring-inset: var(--tw-empty,/*!*/ /*!*/); --tw-ring-offset-width: 0px; --tw-ring-offset-color: #fff; --tw-ring-color: #2563eb; --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color); box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow); border-color: #2563eb; }  input::-moz-placeholder, textarea::-moz-placeholder { color: #6b7280; opacity: 1; }  input::placeholder,textarea::placeholder { color: #6b7280; opacity: 1; }  ::-webkit-datetime-edit-fields-wrapper { padding: 0; }  ::-webkit-date-and-time-value { min-height: 1.5em; }  ::-webkit-datetime-edit,::-webkit-datetime-edit-year-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-meridiem-field { padding-top: 0; padding-bottom: 0; }  select { background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' fill=\'none\' viewBox=\'0 0 20 20\'%3e%3cpath stroke=\'%236b7280\' stroke-linecap=\'round\' stroke-linejoin=\'round\' stroke-width=\'1.5\' d=\'M6 8l4 4 4-4\'/%3e%3c/svg%3e"); background-position: right 0.5rem center; background-repeat: no-repeat; background-size: 1.5em 1.5em; padding-right: 2.5rem; -webkit-print-color-adjust: exact; print-color-adjust: exact; }  [multiple] { background-image: initial; background-position: initial; background-repeat: unset; background-size: initial; padding-right: 0.75rem; -webkit-print-color-adjust: unset; print-color-adjust: unset; }  [type=\'checkbox\'],[type=\'radio\'] { -webkit-appearance: none; -moz-appearance: none; appearance: none; padding: 0; -webkit-print-color-adjust: exact; print-color-adjust: exact; display: inline-block; vertical-align: middle; background-origin: border-box; -webkit-user-select: none; -moz-user-select: none; user-select: none; flex-shrink: 0; height: 1rem; width: 1rem; color: #2563eb; background-color: #fff; border-color: #6b7280; border-width: 1px; --tw-shadow: 0 0 #0000; }  [type=\'checkbox\'] { border-radius: 0px; }  [type=\'radio\'] { border-radius: 100%; }  [type=\'checkbox\']:focus,[type=\'radio\']:focus { outline: 2px solid transparent; outline-offset: 2px; --tw-ring-inset: var(--tw-empty,/*!*/ /*!*/); --tw-ring-offset-width: 2px; --tw-ring-offset-color: #fff; --tw-ring-color: #2563eb; --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color); --tw-ring-shadow: var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color); box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow); }  [type=\'checkbox\']:checked,[type=\'radio\']:checked { border-color: transparent; background-color: currentColor; background-size: 100% 100%; background-position: center; background-repeat: no-repeat; }  [type=\'checkbox\']:checked { background-image: url("data:image/svg+xml,%3csvg viewBox=\'0 0 16 16\' fill=\'white\' xmlns=\'http://www.w3.org/2000/svg\'%3e%3cpath d=\'M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z\'/%3e%3c/svg%3e"); }  [type=\'radio\']:checked { background-image: url("data:image/svg+xml,%3csvg viewBox=\'0 0 16 16\' fill=\'white\' xmlns=\'http://www.w3.org/2000/svg\'%3e%3ccircle cx=\'8\' cy=\'8\' r=\'3\'/%3e%3c/svg%3e"); }  [type=\'checkbox\']:checked:hover,[type=\'checkbox\']:checked:focus,[type=\'radio\']:checked:hover,[type=\'radio\']:checked:focus { border-color: transparent; background-color: currentColor; }  [type=\'checkbox\']:indeterminate { background-image: url("data:image/svg+xml,%3csvg xmlns=\'http://www.w3.org/2000/svg\' fill=\'none\' viewBox=\'0 0 16 16\'%3e%3cpath stroke=\'white\' stroke-linecap=\'round\' stroke-linejoin=\'round\' stroke-width=\'2\' d=\'M4 8h8\'/%3e%3c/svg%3e"); border-color: transparent; background-color: currentColor; background-size: 100% 100%; background-position: center; background-repeat: no-repeat; }  [type=\'checkbox\']:indeterminate:hover,[type=\'checkbox\']:indeterminate:focus { border-color: transparent; background-color: currentColor; }  [type=\'file\'] { background: unset; border-color: inherit; border-width: 0; border-radius: 0; padding: 0; font-size: unset; line-height: inherit; }  [type=\'file\']:focus { outline: 1px solid ButtonText; outline: 1px auto -webkit-focus-ring-color; }  @supports (font-variation-settings: normal) { @font-face { font-family: \'Inter var\';  font-style: normal;  font-weight: 100 900;  font-display: swap;  font-named-instance: \'Regular\';  src: url("https://justnote.cc/static/media/Inter-roman.var.ba4caefcdf5b36b438db.woff2") format("woff2"); }  @font-face { font-family: \'Inter var\';  font-style: italic;  font-weight: 100 900;  font-display: swap;  font-named-instance: \'Italic\';  src: url("https://justnote.cc/static/media/Inter-italic.var.30807be7abc48ba8c73c.woff2") format("woff2"); } }  @supports not (font-variation-settings: normal) { @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 100;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-Thin.fff2a096db014f6239d4.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-Thin.29b9c616a95a912abf73.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 100;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-ThinItalic.bf213704dce6b437ede4.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-ThinItalic.bae95eb2f889c797e435.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 200;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-ExtraLight.72505e6a122c6acd5471.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-ExtraLight.c4248615291a9e8f1fb7.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 200;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-ExtraLightItalic.5c7d7d6deb1d2ec8d48c.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-ExtraLightItalic.170dddfca278d3c2ad4a.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 300;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-Light.2d5198822ab091ce4305.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-Light.994e34451cc19ede31d3.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 300;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-LightItalic.f86952265d7b0f02c921.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-LightItalic.ef9f65d91d2b0ba9b2e4.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 400;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-Regular.c8ba52b05a9ef10f4758.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-Regular.8c206db99195777c6769.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 400;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-Italic.cb10ffd7684cd9836a05.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-Italic.890025e726861dba417f.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 500;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-Medium.293fd13dbca5a3e450ef.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-Medium.9053572c46aeb4b16caa.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 500;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-MediumItalic.085cb93e613ba3d40d2b.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-MediumItalic.3d0107dd43d0101274d3.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 600;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-SemiBold.b5f0f109bc88052d4000.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-SemiBold.cca62d21c8c555c392e5.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 600;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-SemiBoldItalic.d9467ee321a8f38aefff.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-SemiBoldItalic.463bdbfb28abad0fa6df.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 700;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-Bold.ec64ea577b0349e055ad.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-Bold.93c1301bd9f486c573b3.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 700;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-BoldItalic.2d26c56a606662486796.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-BoldItalic.b376885042f6c961a541.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 800;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-ExtraBold.cbe0ae49c52c920fd563.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-ExtraBold.d0fa3bb2b7c9063dc594.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 800;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-ExtraBoldItalic.535a6cf662596b3bd6a6.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-ExtraBoldItalic.6ab17abedc4d3f140953.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  normal;  font-weight: 900;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-Black.15ca31c0a2a68f76d2d1.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-Black.c6938660eec019fefd68.woff") format("woff"); }  @font-face { font-family: \'Inter\';  font-style:  italic;  font-weight: 900;  font-display: swap;  src: url("https://justnote.cc/static/media/Inter-BlackItalic.cb2a7335650c690077fe.woff2") format("woff2"), url("https://justnote.cc/static/media/Inter-BlackItalic.ca1e738e4f349f27514d.woff") format("woff"); } }  html { font-family: "Inter", ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; -webkit-tap-highlight-color: rgba(0, 0, 0, 0.1); }  @supports (font-variation-settings: normal) { html { font-family: "Inter var", ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; } }  *, ::before, ::after { --tw-border-spacing-x: 0; --tw-border-spacing-y: 0; --tw-translate-x: 0; --tw-translate-y: 0; --tw-rotate: 0; --tw-skew-x: 0; --tw-skew-y: 0; --tw-scale-x: 1; --tw-scale-y: 1; --tw-pan-x:  ; --tw-pan-y:  ; --tw-pinch-zoom:  ; --tw-scroll-snap-strictness: proximity; --tw-ordinal:  ; --tw-slashed-zero:  ; --tw-numeric-figure:  ; --tw-numeric-spacing:  ; --tw-numeric-fraction:  ; --tw-ring-inset:  ; --tw-ring-offset-width: 0px; --tw-ring-offset-color: #fff; --tw-ring-color: rgb(59 130 246 / 0.5); --tw-ring-offset-shadow: 0 0 #0000; --tw-ring-shadow: 0 0 #0000; --tw-shadow: 0 0 #0000; --tw-shadow-colored: 0 0 #0000; --tw-blur:  ; --tw-brightness:  ; --tw-contrast:  ; --tw-grayscale:  ; --tw-hue-rotate:  ; --tw-invert:  ; --tw-saturate:  ; --tw-sepia:  ; --tw-drop-shadow:  ; --tw-backdrop-blur:  ; --tw-backdrop-brightness:  ; --tw-backdrop-contrast:  ; --tw-backdrop-grayscale:  ; --tw-backdrop-hue-rotate:  ; --tw-backdrop-invert:  ; --tw-backdrop-opacity:  ; --tw-backdrop-saturate:  ; --tw-backdrop-sepia:  ; }  ::backdrop { --tw-border-spacing-x: 0; --tw-border-spacing-y: 0; --tw-translate-x: 0; --tw-translate-y: 0; --tw-rotate: 0; --tw-skew-x: 0; --tw-skew-y: 0; --tw-scale-x: 1; --tw-scale-y: 1; --tw-pan-x:  ; --tw-pan-y:  ; --tw-pinch-zoom:  ; --tw-scroll-snap-strictness: proximity; --tw-ordinal:  ; --tw-slashed-zero:  ; --tw-numeric-figure:  ; --tw-numeric-spacing:  ; --tw-numeric-fraction:  ; --tw-ring-inset:  ; --tw-ring-offset-width: 0px; --tw-ring-offset-color: #fff; --tw-ring-color: rgb(59 130 246 / 0.5); --tw-ring-offset-shadow: 0 0 #0000; --tw-ring-shadow: 0 0 #0000; --tw-shadow: 0 0 #0000; --tw-shadow-colored: 0 0 #0000; --tw-blur:  ; --tw-brightness:  ; --tw-contrast:  ; --tw-grayscale:  ; --tw-hue-rotate:  ; --tw-invert:  ; --tw-saturate:  ; --tw-sepia:  ; --tw-drop-shadow:  ; --tw-backdrop-blur:  ; --tw-backdrop-brightness:  ; --tw-backdrop-contrast:  ; --tw-backdrop-grayscale:  ; --tw-backdrop-hue-rotate:  ; --tw-backdrop-invert:  ; --tw-backdrop-opacity:  ; --tw-backdrop-saturate:  ; --tw-backdrop-sepia:  ; }  .prose { color: var(--tw-prose-body); max-width: 65ch; }  .prose :where([class~="lead"]):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-lead); font-size: 1.25em; line-height: 1.6; margin-top: 1.2em; margin-bottom: 1.2em; }  .prose :where(a):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-links); text-decoration: underline; font-weight: 500; }  .prose :where(strong):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-bold); font-weight: 600; }  .prose :where(a strong):not(:where([class~="not-prose"] *)) { color: inherit; }  .prose :where(blockquote strong):not(:where([class~="not-prose"] *)) { color: inherit; }  .prose :where(thead th strong):not(:where([class~="not-prose"] *)) { color: inherit; }  .prose :where(ol):not(:where([class~="not-prose"] *)) { list-style-type: decimal; margin-top: 1.25em; margin-bottom: 1.25em; padding-left: 1.625em; }  .prose :where(ol[type="A"]):not(:where([class~="not-prose"] *)) { list-style-type: upper-alpha; }  .prose :where(ol[type="a"]):not(:where([class~="not-prose"] *)) { list-style-type: lower-alpha; }  .prose :where(ol[type="A" s]):not(:where([class~="not-prose"] *)) { list-style-type: upper-alpha; }  .prose :where(ol[type="a" s]):not(:where([class~="not-prose"] *)) { list-style-type: lower-alpha; }  .prose :where(ol[type="I"]):not(:where([class~="not-prose"] *)) { list-style-type: upper-roman; }  .prose :where(ol[type="i"]):not(:where([class~="not-prose"] *)) { list-style-type: lower-roman; }  .prose :where(ol[type="I" s]):not(:where([class~="not-prose"] *)) { list-style-type: upper-roman; }  .prose :where(ol[type="i" s]):not(:where([class~="not-prose"] *)) { list-style-type: lower-roman; }  .prose :where(ol[type="1"]):not(:where([class~="not-prose"] *)) { list-style-type: decimal; }  .prose :where(ul):not(:where([class~="not-prose"] *)) { list-style-type: disc; margin-top: 1.25em; margin-bottom: 1.25em; padding-left: 1.625em; }  .prose :where(ol > li):not(:where([class~="not-prose"] *))::marker { font-weight: 400; color: var(--tw-prose-counters); }  .prose :where(ul > li):not(:where([class~="not-prose"] *))::marker { color: var(--tw-prose-bullets); }  .prose :where(hr):not(:where([class~="not-prose"] *)) { border-color: var(--tw-prose-hr); border-top-width: 1px; margin-top: 3em; margin-bottom: 3em; }  .prose :where(blockquote):not(:where([class~="not-prose"] *)) { font-weight: 500; font-style: italic; color: var(--tw-prose-quotes); border-left-width: 0.25rem; border-left-color: var(--tw-prose-quote-borders); quotes: "\\201C""\\201D""\\2018""\\2019"; margin-top: 1.6em; margin-bottom: 1.6em; padding-left: 1em; }  .prose :where(blockquote p:first-of-type):not(:where([class~="not-prose"] *))::before { content: open-quote; }  .prose :where(blockquote p:last-of-type):not(:where([class~="not-prose"] *))::after { content: close-quote; }  .prose :where(h1):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-headings); font-weight: 800; font-size: 2.25em; margin-top: 0; margin-bottom: 0.8888889em; line-height: 1.1111111; }  .prose :where(h1 strong):not(:where([class~="not-prose"] *)) { font-weight: 900; color: inherit; }  .prose :where(h2):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-headings); font-weight: 700; font-size: 1.5em; margin-top: 2em; margin-bottom: 1em; line-height: 1.3333333; }  .prose :where(h2 strong):not(:where([class~="not-prose"] *)) { font-weight: 800; color: inherit; }  .prose :where(h3):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-headings); font-weight: 600; font-size: 1.25em; margin-top: 1.6em; margin-bottom: 0.6em; line-height: 1.6; }  .prose :where(h3 strong):not(:where([class~="not-prose"] *)) { font-weight: 700; color: inherit; }  .prose :where(h4):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-headings); font-weight: 600; margin-top: 1.5em; margin-bottom: 0.5em; line-height: 1.5; }  .prose :where(h4 strong):not(:where([class~="not-prose"] *)) { font-weight: 700; color: inherit; }  .prose :where(img):not(:where([class~="not-prose"] *)) { margin-top: 2em; margin-bottom: 2em; }  .prose :where(figure > *):not(:where([class~="not-prose"] *)) { margin-top: 0; margin-bottom: 0; }  .prose :where(figcaption):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-captions); font-size: 0.875em; line-height: 1.4285714; margin-top: 0.8571429em; }  .prose :where(code):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-code); font-weight: 600; font-size: 0.875em; }  .prose :where(code):not(:where([class~="not-prose"] *))::before { content: "`"; }  .prose :where(code):not(:where([class~="not-prose"] *))::after { content: "`"; }  .prose :where(a code):not(:where([class~="not-prose"] *)) { color: inherit; }  .prose :where(h1 code):not(:where([class~="not-prose"] *)) { color: inherit; }  .prose :where(h2 code):not(:where([class~="not-prose"] *)) { color: inherit; font-size: 0.875em; }  .prose :where(h3 code):not(:where([class~="not-prose"] *)) { color: inherit; font-size: 0.9em; }  .prose :where(h4 code):not(:where([class~="not-prose"] *)) { color: inherit; }  .prose :where(blockquote code):not(:where([class~="not-prose"] *)) { color: inherit; }  .prose :where(thead th code):not(:where([class~="not-prose"] *)) { color: inherit; }  .prose :where(pre):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-pre-code); background-color: var(--tw-prose-pre-bg); overflow-x: auto; font-weight: 400; font-size: 0.875em; line-height: 1.7142857; margin-top: 1.7142857em; margin-bottom: 1.7142857em; border-radius: 0.375rem; padding-top: 0.8571429em; padding-right: 1.1428571em; padding-bottom: 0.8571429em; padding-left: 1.1428571em; }  .prose :where(pre code):not(:where([class~="not-prose"] *)) { background-color: transparent; border-width: 0; border-radius: 0; padding: 0; font-weight: inherit; color: inherit; font-size: inherit; font-family: inherit; line-height: inherit; }  .prose :where(pre code):not(:where([class~="not-prose"] *))::before { content: none; }  .prose :where(pre code):not(:where([class~="not-prose"] *))::after { content: none; }  .prose :where(table):not(:where([class~="not-prose"] *)) { width: 100%; table-layout: auto; text-align: left; margin-top: 2em; margin-bottom: 2em; font-size: 0.875em; line-height: 1.7142857; }  .prose :where(thead):not(:where([class~="not-prose"] *)) { border-bottom-width: 1px; border-bottom-color: var(--tw-prose-th-borders); }  .prose :where(thead th):not(:where([class~="not-prose"] *)) { color: var(--tw-prose-headings); font-weight: 600; vertical-align: bottom; padding-right: 0.5714286em; padding-bottom: 0.5714286em; padding-left: 0.5714286em; }  .prose :where(tbody tr):not(:where([class~="not-prose"] *)) { border-bottom-width: 1px; border-bottom-color: var(--tw-prose-td-borders); }  .prose :where(tbody tr:last-child):not(:where([class~="not-prose"] *)) { border-bottom-width: 0; }  .prose :where(tbody td):not(:where([class~="not-prose"] *)) { vertical-align: baseline; }  .prose :where(tfoot):not(:where([class~="not-prose"] *)) { border-top-width: 1px; border-top-color: var(--tw-prose-th-borders); }  .prose :where(tfoot td):not(:where([class~="not-prose"] *)) { vertical-align: top; }  .prose { --tw-prose-body: #374151; --tw-prose-headings: #111827; --tw-prose-lead: #4b5563; --tw-prose-links: #111827; --tw-prose-bold: #111827; --tw-prose-counters: #6b7280; --tw-prose-bullets: #d1d5db; --tw-prose-hr: #e5e7eb; --tw-prose-quotes: #111827; --tw-prose-quote-borders: #e5e7eb; --tw-prose-captions: #6b7280; --tw-prose-code: #111827; --tw-prose-pre-code: #e5e7eb; --tw-prose-pre-bg: #1f2937; --tw-prose-th-borders: #d1d5db; --tw-prose-td-borders: #e5e7eb; --tw-prose-invert-body: #d1d5db; --tw-prose-invert-headings: #fff; --tw-prose-invert-lead: #9ca3af; --tw-prose-invert-links: #fff; --tw-prose-invert-bold: #fff; --tw-prose-invert-counters: #9ca3af; --tw-prose-invert-bullets: #4b5563; --tw-prose-invert-hr: #374151; --tw-prose-invert-quotes: #f3f4f6; --tw-prose-invert-quote-borders: #374151; --tw-prose-invert-captions: #9ca3af; --tw-prose-invert-code: #fff; --tw-prose-invert-pre-code: #d1d5db; --tw-prose-invert-pre-bg: rgb(0 0 0 / 50%); --tw-prose-invert-th-borders: #4b5563; --tw-prose-invert-td-borders: #374151; font-size: 1rem; line-height: 1.75; }  .prose :where(p):not(:where([class~="not-prose"] *)) { margin-top: 1.25em; margin-bottom: 1.25em; }  .prose :where(video):not(:where([class~="not-prose"] *)) { margin-top: 2em; margin-bottom: 2em; }  .prose :where(figure):not(:where([class~="not-prose"] *)) { margin-top: 2em; margin-bottom: 2em; }  .prose :where(li):not(:where([class~="not-prose"] *)) { margin-top: 0.5em; margin-bottom: 0.5em; }  .prose :where(ol > li):not(:where([class~="not-prose"] *)) { padding-left: 0.375em; }  .prose :where(ul > li):not(:where([class~="not-prose"] *)) { padding-left: 0.375em; }  .prose :where(.prose > ul > li p):not(:where([class~="not-prose"] *)) { margin-top: 0.75em; margin-bottom: 0.75em; }  .prose :where(.prose > ul > li > *:first-child):not(:where([class~="not-prose"] *)) { margin-top: 1.25em; }  .prose :where(.prose > ul > li > *:last-child):not(:where([class~="not-prose"] *)) { margin-bottom: 1.25em; }  .prose :where(.prose > ol > li > *:first-child):not(:where([class~="not-prose"] *)) { margin-top: 1.25em; }  .prose :where(.prose > ol > li > *:last-child):not(:where([class~="not-prose"] *)) { margin-bottom: 1.25em; }  .prose :where(ul ul, ul ol, ol ul, ol ol):not(:where([class~="not-prose"] *)) { margin-top: 0.75em; margin-bottom: 0.75em; }  .prose :where(hr + *):not(:where([class~="not-prose"] *)) { margin-top: 0; }  .prose :where(h2 + *):not(:where([class~="not-prose"] *)) { margin-top: 0; }  .prose :where(h3 + *):not(:where([class~="not-prose"] *)) { margin-top: 0; }  .prose :where(h4 + *):not(:where([class~="not-prose"] *)) { margin-top: 0; }  .prose :where(thead th:first-child):not(:where([class~="not-prose"] *)) { padding-left: 0; }  .prose :where(thead th:last-child):not(:where([class~="not-prose"] *)) { padding-right: 0; }  .prose :where(tbody td, tfoot td):not(:where([class~="not-prose"] *)) { padding-top: 0.5714286em; padding-right: 0.5714286em; padding-bottom: 0.5714286em; padding-left: 0.5714286em; }  .prose :where(tbody td:first-child, tfoot td:first-child):not(:where([class~="not-prose"] *)) { padding-left: 0; }  .prose :where(tbody td:last-child, tfoot td:last-child):not(:where([class~="not-prose"] *)) { padding-right: 0; }  .prose :where(.prose > :first-child):not(:where([class~="not-prose"] *)) { margin-top: 0; }  .prose :where(.prose > :last-child):not(:where([class~="not-prose"] *)) { margin-bottom: 0; }  .mx-auto { margin-left: auto; margin-right: auto; }  .break-all { word-break: break-all; }  .antialiased { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }  .prose-h1\\:mb-\\[0\\.6967em\\] :is(:where(h1):not(:where([class~="not-prose"] *))) { margin-bottom: 0.6967em; }  .prose-h1\\:leading-normal :is(:where(h1):not(:where([class~="not-prose"] *))) { line-height: 1.5; }  .prose-p\\:my-0 :is(:where(p):not(:where([class~="not-prose"] *))) { margin-top: 0px; margin-bottom: 0px; }  .prose-ol\\:my-0 :is(:where(ol):not(:where([class~="not-prose"] *))) { margin-top: 0px; margin-bottom: 0px; }  .prose-ol\\:pl-10 :is(:where(ol):not(:where([class~="not-prose"] *))) { padding-left: 2.5rem; }  .prose-ul\\:my-0 :is(:where(ul):not(:where([class~="not-prose"] *))) { margin-top: 0px; margin-bottom: 0px; }  .prose-ul\\:pl-10 :is(:where(ul):not(:where([class~="not-prose"] *))) { padding-left: 2.5rem; }  .prose-li\\:my-0 :is(:where(li):not(:where([class~="not-prose"] *))) { margin-top: 0px; margin-bottom: 0px; }  .prose-li\\:pl-0 :is(:where(li):not(:where([class~="not-prose"] *))) { padding-left: 0px; } </style> <style>.text-tiny { font-size: 0.7em; }  .text-small { font-size: 0.85em; }  .text-big { font-size: 1.4em; }  .text-huge { font-size: 1.8em; }  .prose { --tw-prose-counters: rgb(55, 65, 81); --tw-prose-bullets: rgb(55, 65, 81);  /* In CKEditor, line height is 1.5. In prose, line height is 1.75. line-height: 1.5; */  --ck-image-style-spacing: 1.5em; --ck-inline-image-style-spacing: calc(var(--ck-image-style-spacing) / 2);  --jn-editor-white: rgb(255, 255, 255); --jn-editor-gray-700: rgb(55, 65, 81); --jn-editor-green-600: rgb(22, 163, 74); }  .prose ul { list-style-type: disc; }  .prose ul ul { list-style-type: circle; }  .prose ul ul ul { list-style-type: square; }  .prose ul ul ul ul { list-style-type: square; }  .prose ol { list-style-type: decimal; }  .prose ol ol { list-style-type: lower-latin; }  .prose ol ol ol { list-style-type: lower-roman; }  .prose ol ol ol ol { list-style-type: upper-latin; }  .prose ol ol ol ol ol { list-style-type: upper-roman; }  .prose .todo-list { list-style: none; }  .prose .todo-list .todo-list__label>input { position: relative; top: -1px; left: -22px; margin-right: -8px; background-color: var(--jn-editor-white); border: 1px solid var(--jn-editor-gray-700); border-radius: 2px; }  .prose .todo-list .todo-list__label>input:checked { background-color: hsl(126, 64%, 41%); border-color: hsl(126, 64%, 41%); }  .prose .image { display: table; clear: both; text-align: center; margin: 0.9em auto; min-width: 50px; }  .prose .image img { display: block; margin: 0 auto; max-width: 100%; min-width: 100% }  .prose img { display: inline-flex; margin: 0; max-width: 100%; /* As here has no span but the editor has so set baseline as span and no need align-items: flex-start; as img has no items. */ vertical-align: baseline; }  .prose .image-style-block-align-left { margin-left: 0; margin-right: auto; }  .prose .image-style-block-align-right { margin-right: 0; margin-left: auto; }  .prose .image-style-align-left { clear: none; float: left; margin-right: var(--ck-image-style-spacing); }  .prose .image-style-align-right { clear: none; float: right; margin-left: var(--ck-image-style-spacing); }  .prose p + .image-style-align-left, .prose p + .image-style-align-right { margin-top: 0; }  .prose p .image-style-align-left { margin-top: var(--ck-inline-image-style-spacing); margin-bottom: var(--ck-inline-image-style-spacing); margin-right: var(--ck-inline-image-style-spacing); }  .prose p .image-style-align-right { margin-top: var(--ck-inline-image-style-spacing); margin-bottom: var(--ck-inline-image-style-spacing); margin-left: var(--ck-inline-image-style-spacing); }  .prose .image.image_resized { max-width: 100%; display: block; box-sizing: border-box; }  .prose .image.image_resized img { width: 100%; }  /* Might need to have image-inline, image-style-align-center, and image-style-side as well. Look at ckeditor5/packages/ckeditor5-image/theme/image.css and imagestyle.css, imageresize.css. */ </style> <style> @page { margin: 64px 48px; padding: 0; } </style> </head> <body class="antialiased"> <article class="prose prose-h1:mb-[0.6967em] prose-h1:leading-normal prose-p:my-0 prose-ol:my-0 prose-ol:pl-10 prose-ul:my-0 prose-ul:pl-10 prose-li:my-0 prose-li:pl-0 mx-auto break-all"> <h1>__-title-__</h1> __-body-__ </article> </body> </html> '},6163:(t,e,o)=>{"use strict";o.d(e,{A6:()=>i,J5:()=>r,Jd:()=>a,mg:()=>s,qf:()=>n});const s=t=>t instanceof Uint8Array||"[object Uint8Array]"===toString.call(t),n=t=>t instanceof Blob||"[object Blob]"===toString.call(t),a=t=>new Promise(((e,o)=>{const s=new FileReader;s.onerror=t=>o(t),s.onload=()=>e(s.result),s.readAsDataURL(t)})),r=async t=>{const e=await fetch(t);return await e.blob()},i=(t,e)=>new Promise((o=>t.toBlob(o,e)))}}]);